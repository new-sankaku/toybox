<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>LIC法による鉛筆画自動生成</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
<h1>LIC法による鉛筆画自動生成</h1>
<p class="subtitle">Line Integral Convolution を利用した鉛筆画変換（完全実装版）</p>
<p class="reference">参考論文: 茅 暁陽ら「LIC法を利用した鉛筆画の自動生成法」芸術科学会論文誌 Vol.1 No.3</p>
<div class="main-content">
<div class="drop-zone" id="dropZone">
<div class="drop-icon">🖼️</div>
<p>画像をドラッグ＆ドロップ</p>
<p class="drop-hint">または クリックして選択</p>
<input type="file" id="fileInput" accept="image/*" hidden>
</div>
<div class="controls" id="controls">
<h3>パラメータ設定</h3>
<div class="control-section">
<h4>ストローク設定</h4>
<div class="control-group">
<label>ストローク長さ (L): <span id="kernelLengthValue">20</span>px</label>
<input type="range" id="kernelLength" min="5" max="50" value="20">
<span class="hint">論文2.2節: カーネルの長さ</span>
</div>
<div class="control-group">
<label>ノイズ粒度: <span id="noiseScaleValue">1</span></label>
<input type="range" id="noiseScale" min="1" max="4" value="1">
<span class="hint">太いストローク効果</span>
</div>
<div class="control-group">
<label>ストローク方向:</label>
<select id="strokeDirection">
<option value="auto">自動（テクスチャ解析＋領域分割）</option>
<option value="texture">テクスチャ解析のみ</option>
<option value="uniform">一様（斜め45°）</option>
<option value="random">ランダム（写実的トーン）</option>
<option value="crosshatch">クロスハッチング</option>
</select>
<span class="hint">論文3.4節: ベクトル場の決定方法</span>
</div>
</div>
<div class="control-section">
<h4>トーン設定</h4>
<div class="control-group">
<label>明るさ係数 (k): <span id="brightnessValue">0.7</span></label>
<input type="range" id="brightness" min="0.3" max="1.0" step="0.05" value="0.7">
<span class="hint">論文3.2節: T = k(1 - I/255)</span>
</div>
</div>
<div class="control-section">
<h4>領域分割設定（論文3.3節）</h4>
<div class="control-group checkbox-group">
<label><input type="checkbox" id="useSegmentation" checked>領域分割を使用</label>
</div>
<div class="control-group">
<label>ブロックサイズ: <span id="blockSizeValue">5</span>px</label>
<input type="range" id="blockSize" min="3" max="15" value="5">
<span class="hint">初期分割の矩形サイズ</span>
</div>
<div class="control-group">
<label>統合閾値: <span id="mergeThresholdValue">0.3</span></label>
<input type="range" id="mergeThreshold" min="0.1" max="0.8" step="0.05" value="0.3">
<span class="hint">ヒストグラム類似度閾値</span>
</div>
<div class="control-group">
<label>最小領域サイズ: <span id="minRegionSizeValue">100</span>px</label>
<input type="range" id="minRegionSize" min="50" max="500" step="50" value="100">
</div>
<div class="control-group checkbox-group">
<label><input type="checkbox" id="drawBoundaries" checked>領域境界を描画</label>
</div>
</div>
<div class="control-section">
<h4>テクスチャ解析設定（論文3.4節）</h4>
<div class="control-group">
<label>FFT窓サイズ: <span id="textureWindowSizeValue">18</span>px</label>
<input type="range" id="textureWindowSize" min="8" max="32" step="2" value="18">
<span class="hint">フーリエ解析の窓領域サイズ</span>
</div>
<div class="control-group">
<label>方向性閾値: <span id="directionThresholdValue">1.5</span></label>
<input type="range" id="directionThreshold" min="1.0" max="3.0" step="0.1" value="1.5">
<span class="hint">ピーク/平均比の閾値</span>
</div>
</div>
<div class="control-section">
<h4>エッジ設定（論文3.3節）</h4>
<div class="control-group">
<label>エッジ強度: <span id="edgeStrengthValue">0.5</span></label>
<input type="range" id="edgeStrength" min="0" max="1" step="0.1" value="0.5">
</div>
<div class="control-group">
<label>エッジモード:</label>
<select id="edgeMode">
<option value="adaptive">適応型（トーン差に応じる）</option>
<option value="fixed">固定</option>
</select>
<span class="hint">論文: 隣接領域のトーン差に応じて調整</span>
</div>
</div>
<div class="control-section">
<h4>紙テクスチャ設定（論文3.5節）</h4>
<div class="control-group">
<label>紙テクスチャ強度: <span id="paperStrengthValue">0.3</span></label>
<input type="range" id="paperStrength" min="0" max="0.8" step="0.05" value="0.3">
<span class="hint">画用紙の地合いの影響</span>
</div>
</div>
<button id="generateBtn" class="generate-btn" disabled>鉛筆画を生成</button>
<button id="downloadBtn" class="download-btn" disabled>画像をダウンロード</button>
</div>
</div>
<div class="canvas-container" id="canvasContainer">
<div class="canvas-wrapper">
<h3>入力画像</h3>
<canvas id="inputCanvas"></canvas>
</div>
<div class="canvas-wrapper">
<h3>鉛筆画出力</h3>
<canvas id="outputCanvas"></canvas>
</div>
</div>
<div class="progress-container" id="progressContainer">
<div class="progress-bar">
<div class="progress-fill" id="progressFill"></div>
</div>
<p class="progress-text" id="progressText">処理中...</p>
</div>
<div class="algorithm-info">
<h3>実装アルゴリズム（論文3.1節）</h3>
<ol>
<li>入力画像からホワイトノイズ画像を生成（トーンマッチング）</li>
<li>入力画像を輝度ヒストグラムに基づいて領域分割</li>
<li>領域の境界を抽出</li>
<li>FFTテクスチャ解析でストローク方向のベクトル場を生成</li>
<li>LIC法（流線積分畳み込み）で鉛筆画を生成</li>
<li>Sobelエッジを合成して輪郭を強調</li>
<li>紙テクスチャを合成して最終画像を生成</li>
</ol>
</div>
</div>
<script src="fft.js"></script>
<script src="segmentation.js"></script>
<script src="lic.js"></script>
<script src="app.js"></script>
</body>
</html>
