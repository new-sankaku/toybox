<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>水の精霊</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:#d8d0c8;display:flex;justify-content:center;align-items:center;min-height:100vh;font-family:sans-serif;}
.container{background:#fff;border-radius:20px;padding:30px;box-shadow:0 10px 40px rgba(0,0,0,0.08);}
h2{text-align:center;color:#8b8178;margin-bottom:15px;font-weight:normal;font-size:18px;}
#canvas{display:block;border-radius:12px;}
</style>
</head>
<body>
<div class="container">
<h2>水の精霊</h2>
<canvas id="canvas" width="400" height="400"></canvas>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
var scene,camera,renderer,character,time=0;
function init(){
scene=new THREE.Scene();
scene.background=new THREE.Color(0xd8d0c8);
camera=new THREE.PerspectiveCamera(50,1,0.1,1000);
camera.position.set(0,2,5);
camera.lookAt(0,1.2,0);
renderer=new THREE.WebGLRenderer({canvas:document.getElementById('canvas'),antialias:true});
renderer.setSize(400,400);
renderer.shadowMap.enabled=true;
renderer.shadowMap.type=THREE.PCFSoftShadowMap;
var ambLight=new THREE.AmbientLight(0xffffff,0.6);
scene.add(ambLight);
var dirLight=new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(5,10,5);
dirLight.castShadow=true;
scene.add(dirLight);
createCharacter();
createFloor();
animate();
}
function createCharacter(){
character=new THREE.Group();
var bodyColor=0xa0c8d8;
var coreColor=0xc0e0e8;
var bubbleColor=0xd8f0f8;
var eyeColor=0x304858;
var cheekColor=0x90c0d8;

// メインボディ（しずく型）
var bodyGeo=new THREE.SphereGeometry(0.45,32,32);
var bodyMat=new THREE.MeshToonMaterial({color:bodyColor,transparent:true,opacity:0.85});
var body=new THREE.Mesh(bodyGeo,bodyMat);
body.scale.set(1,1.3,1);
body.position.y=1.2;
character.add(body);
character.body=body;

// 内側のコア
var coreGeo=new THREE.SphereGeometry(0.3,24,24);
var coreMat=new THREE.MeshToonMaterial({color:coreColor,transparent:true,opacity:0.7});
var core=new THREE.Mesh(coreGeo,coreMat);
core.position.y=1.25;
character.add(core);
character.core=core;

// 頭の水滴トップ
var dropTopGeo=new THREE.ConeGeometry(0.15,0.3,16);
var dropTopMat=new THREE.MeshToonMaterial({color:bodyColor,transparent:true,opacity:0.8});
var dropTop=new THREE.Mesh(dropTopGeo,dropTopMat);
dropTop.position.y=1.95;
character.add(dropTop);
character.dropTop=dropTop;

// 目
var eyeGeo=new THREE.SphereGeometry(0.09,16,16);
var eyeMat=new THREE.MeshToonMaterial({color:eyeColor});
var leftEye=new THREE.Mesh(eyeGeo,eyeMat);
leftEye.position.set(-0.14,1.35,0.38);
character.add(leftEye);
var rightEye=new THREE.Mesh(eyeGeo,eyeMat);
rightEye.position.set(0.14,1.35,0.38);
character.add(rightEye);

// 瞳ハイライト
var highlightGeo=new THREE.SphereGeometry(0.03,8,8);
var highlightMat=new THREE.MeshToonMaterial({color:0xffffff});
var leftHighlight=new THREE.Mesh(highlightGeo,highlightMat);
leftHighlight.position.set(-0.12,1.38,0.46);
character.add(leftHighlight);
var rightHighlight=new THREE.Mesh(highlightGeo,highlightMat);
rightHighlight.position.set(0.16,1.38,0.46);
character.add(rightHighlight);

// 頬
var cheekGeo=new THREE.SphereGeometry(0.06,12,12);
var cheekMat=new THREE.MeshToonMaterial({color:cheekColor,transparent:true,opacity:0.7});
var leftCheek=new THREE.Mesh(cheekGeo,cheekMat);
leftCheek.position.set(-0.28,1.2,0.32);
leftCheek.scale.set(1,0.6,0.5);
character.add(leftCheek);
var rightCheek=new THREE.Mesh(cheekGeo,cheekMat);
rightCheek.position.set(0.28,1.2,0.32);
rightCheek.scale.set(1,0.6,0.5);
character.add(rightCheek);

// 泡
character.bubbles=[];
for(var i=0;i<12;i++){
var size=0.03+Math.random()*0.05;
var bubble=new THREE.Mesh(
new THREE.SphereGeometry(size,10,10),
new THREE.MeshToonMaterial({color:bubbleColor,transparent:true,opacity:0.6})
);
var angle=Math.random()*Math.PI*2;
var radius=0.3+Math.random()*0.4;
bubble.position.set(
Math.sin(angle)*radius,
0.7+Math.random()*1.2,
Math.cos(angle)*radius
);
character.add(bubble);
character.bubbles.push({
mesh:bubble,
angle:angle,
radius:radius,
speed:0.3+Math.random()*0.4,
baseY:bubble.position.y
});
}

// 水のリング
character.rings=[];
for(var i=0;i<3;i++){
var ringGeo=new THREE.TorusGeometry(0.35+i*0.15,0.02,8,32);
var ringMat=new THREE.MeshToonMaterial({color:coreColor,transparent:true,opacity:0.5-i*0.1});
var ring=new THREE.Mesh(ringGeo,ringMat);
ring.position.y=0.9+i*0.25;
ring.rotation.x=Math.PI/2;
character.add(ring);
character.rings.push(ring);
}

// 水の波紋（下部）
character.ripples=[];
for(var i=0;i<3;i++){
var rippleGeo=new THREE.RingGeometry(0.2+i*0.2,0.25+i*0.2,32);
var rippleMat=new THREE.MeshToonMaterial({color:bodyColor,transparent:true,opacity:0.4-i*0.1,side:THREE.DoubleSide});
var ripple=new THREE.Mesh(rippleGeo,rippleMat);
ripple.position.y=0.05;
ripple.rotation.x=-Math.PI/2;
character.add(ripple);
character.ripples.push({mesh:ripple,baseScale:1+i*0.5});
}

// 小さな水滴（周囲を漂う）
character.droplets=[];
for(var i=0;i<6;i++){
var droplet=new THREE.Mesh(
new THREE.SphereGeometry(0.06,12,12),
new THREE.MeshToonMaterial({color:coreColor,transparent:true,opacity:0.7})
);
droplet.scale.set(0.8,1.2,0.8);
var angle=i*Math.PI*2/6;
droplet.position.set(Math.sin(angle)*0.7,1.2,Math.cos(angle)*0.7);
character.add(droplet);
character.droplets.push({mesh:droplet,angle:angle});
}

scene.add(character);
}
function createFloor(){
var floorGeo=new THREE.CircleGeometry(2,32);
var floorMat=new THREE.MeshToonMaterial({color:0xcac4bc});
var floor=new THREE.Mesh(floorGeo,floorMat);
floor.rotation.x=-Math.PI/2;
floor.position.y=0;
floor.receiveShadow=true;
scene.add(floor);
}
function animate(){
requestAnimationFrame(animate);
time+=0.03;
// ボディの揺らぎ
character.body.scale.x=1+Math.sin(time*2)*0.05;
character.body.scale.z=1+Math.cos(time*2)*0.05;
// コアの脈動
character.core.scale.setScalar(1+Math.sin(time*3)*0.1);
// トップの揺れ
character.dropTop.rotation.z=Math.sin(time*2)*0.1;
character.dropTop.position.y=1.95+Math.sin(time*2.5)*0.03;
// 泡の上昇
character.bubbles.forEach(function(b){
b.mesh.position.y+=b.speed*0.01;
if(b.mesh.position.y>2.2){
b.mesh.position.y=0.7;
}
b.mesh.position.x=Math.sin(b.angle+time)*b.radius;
b.mesh.position.z=Math.cos(b.angle+time)*b.radius;
b.mesh.material.opacity=0.3+Math.sin(time*5+b.angle)*0.3;
});
// リングの回転
character.rings.forEach(function(r,i){
r.rotation.z=time*(0.5+i*0.2);
r.scale.setScalar(1+Math.sin(time*2+i)*0.1);
});
// 波紋の拡大
character.ripples.forEach(function(r,i){
var scale=r.baseScale+Math.sin(time*2-i*0.5)*0.2;
r.mesh.scale.setScalar(scale);
r.mesh.material.opacity=0.3-Math.sin(time*2-i*0.5)*0.15;
});
// 水滴の周回
character.droplets.forEach(function(d,i){
d.mesh.position.x=Math.sin(d.angle+time*0.8)*0.7;
d.mesh.position.z=Math.cos(d.angle+time*0.8)*0.7;
d.mesh.position.y=1.2+Math.sin(time*3+i)*0.15;
});
// 全体の浮遊
character.position.y=Math.sin(time*1.2)*0.08;
// 全体の回転
character.rotation.y+=0.008;
renderer.render(scene,camera);
}
init();
</script>
</body>
</html>
