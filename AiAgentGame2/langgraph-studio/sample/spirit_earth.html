<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>土の精霊</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:#d8d0c8;display:flex;justify-content:center;align-items:center;min-height:100vh;font-family:sans-serif;}
.container{background:#fff;border-radius:20px;padding:30px;box-shadow:0 10px 40px rgba(0,0,0,0.08);}
h2{text-align:center;color:#8b8178;margin-bottom:15px;font-weight:normal;font-size:18px;}
#canvas{display:block;border-radius:12px;}
</style>
</head>
<body>
<div class="container">
<h2>土の精霊</h2>
<canvas id="canvas" width="400" height="400"></canvas>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
var scene,camera,renderer,character,time=0;
function init(){
scene=new THREE.Scene();
scene.background=new THREE.Color(0xd8d0c8);
camera=new THREE.PerspectiveCamera(50,1,0.1,1000);
camera.position.set(0,2,5);
camera.lookAt(0,1,0);
renderer=new THREE.WebGLRenderer({canvas:document.getElementById('canvas'),antialias:true});
renderer.setSize(400,400);
renderer.shadowMap.enabled=true;
renderer.shadowMap.type=THREE.PCFSoftShadowMap;
var ambLight=new THREE.AmbientLight(0xffffff,0.6);
scene.add(ambLight);
var dirLight=new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(5,10,5);
dirLight.castShadow=true;
scene.add(dirLight);
createCharacter();
createFloor();
animate();
}
function createCharacter(){
character=new THREE.Group();
var bodyColor=0xc0a890;
var rockColor=0xa08870;
var darkRockColor=0x806850;
var crystalColor=0xd0c8a0;
var eyeColor=0x403830;
var cheekColor=0xc8a080;
var mossColor=0x90a880;

// メインボディ（岩のような不規則な形）
var bodyGeo=new THREE.DodecahedronGeometry(0.5,1);
var bodyMat=new THREE.MeshToonMaterial({color:bodyColor});
var body=new THREE.Mesh(bodyGeo,bodyMat);
body.position.y=1.1;
body.castShadow=true;
character.add(body);
character.body=body;

// 頭部
var headGeo=new THREE.DodecahedronGeometry(0.35,1);
var headMat=new THREE.MeshToonMaterial({color:bodyColor});
var head=new THREE.Mesh(headGeo,headMat);
head.position.set(0,1.7,0.1);
head.castShadow=true;
character.add(head);
character.head=head;

// 目
var eyeGeo=new THREE.SphereGeometry(0.08,16,16);
var eyeMat=new THREE.MeshToonMaterial({color:eyeColor});
var leftEye=new THREE.Mesh(eyeGeo,eyeMat);
leftEye.position.set(-0.14,1.75,0.3);
character.add(leftEye);
var rightEye=new THREE.Mesh(eyeGeo,eyeMat);
rightEye.position.set(0.14,1.75,0.3);
character.add(rightEye);

// 瞳ハイライト
var highlightGeo=new THREE.SphereGeometry(0.025,8,8);
var highlightMat=new THREE.MeshToonMaterial({color:0xffffff});
var leftHighlight=new THREE.Mesh(highlightGeo,highlightMat);
leftHighlight.position.set(-0.12,1.77,0.38);
character.add(leftHighlight);
var rightHighlight=new THREE.Mesh(highlightGeo,highlightMat);
rightHighlight.position.set(0.16,1.77,0.38);
character.add(rightHighlight);

// 頬
var cheekGeo=new THREE.SphereGeometry(0.06,12,12);
var cheekMat=new THREE.MeshToonMaterial({color:cheekColor});
var leftCheek=new THREE.Mesh(cheekGeo,cheekMat);
leftCheek.position.set(-0.25,1.65,0.25);
leftCheek.scale.set(1,0.6,0.5);
character.add(leftCheek);
var rightCheek=new THREE.Mesh(cheekGeo,cheekMat);
rightCheek.position.set(0.25,1.65,0.25);
rightCheek.scale.set(1,0.6,0.5);
character.add(rightCheek);

// 小さな岩（周囲に）
character.rocks=[];
var rockPositions=[
{x:-0.5,y:0.3,z:0.3,s:0.15},
{x:0.55,y:0.25,z:-0.2,s:0.12},
{x:-0.3,y:0.2,z:-0.5,s:0.18},
{x:0.4,y:0.35,z:0.4,s:0.1},
{x:0,y:0.2,z:0.6,s:0.14}
];
rockPositions.forEach(function(pos){
var rock=new THREE.Mesh(
new THREE.DodecahedronGeometry(pos.s,0),
new THREE.MeshToonMaterial({color:rockColor})
);
rock.position.set(pos.x,pos.y,pos.z);
rock.rotation.set(Math.random(),Math.random(),Math.random());
character.add(rock);
character.rocks.push(rock);
});

// 浮遊する岩
character.floatingRocks=[];
for(var i=0;i<4;i++){
var angle=i*Math.PI/2;
var fRock=new THREE.Mesh(
new THREE.DodecahedronGeometry(0.08,0),
new THREE.MeshToonMaterial({color:darkRockColor})
);
fRock.position.set(Math.sin(angle)*0.7,1.2,Math.cos(angle)*0.7);
character.add(fRock);
character.floatingRocks.push({mesh:fRock,angle:angle,baseY:1.2});
}

// クリスタル
character.crystals=[];
var crystalPositions=[
{x:-0.25,y:2,z:0.05,s:0.08,r:0.2},
{x:0.2,y:2.05,z:-0.1,s:0.06,r:-0.3},
{x:0,y:2.1,z:0.15,s:0.1,r:0}
];
crystalPositions.forEach(function(pos){
var crystalGeo=new THREE.ConeGeometry(pos.s,pos.s*3,6);
var crystalMat=new THREE.MeshToonMaterial({color:crystalColor,transparent:true,opacity:0.85});
var crystal=new THREE.Mesh(crystalGeo,crystalMat);
crystal.position.set(pos.x,pos.y,pos.z);
crystal.rotation.z=pos.r;
character.add(crystal);
character.crystals.push(crystal);
});

// 苔
var mossPositions=[
{x:-0.3,y:1.4,z:0.35},{x:0.35,y:1.35,z:0.25},{x:-0.15,y:1.0,z:0.45}
];
mossPositions.forEach(function(pos){
var moss=new THREE.Mesh(
new THREE.SphereGeometry(0.08,8,8),
new THREE.MeshToonMaterial({color:mossColor})
);
moss.position.set(pos.x,pos.y,pos.z);
moss.scale.set(1.5,0.5,1);
character.add(moss);
});

// 腕（岩の塊）
var armMat=new THREE.MeshToonMaterial({color:rockColor});
var leftArmGroup=new THREE.Group();
var leftArm=new THREE.Mesh(new THREE.DodecahedronGeometry(0.15,0),armMat);
leftArmGroup.add(leftArm);
var leftHand=new THREE.Mesh(new THREE.DodecahedronGeometry(0.1,0),new THREE.MeshToonMaterial({color:darkRockColor}));
leftHand.position.y=-0.25;
leftArmGroup.add(leftHand);
leftArmGroup.position.set(-0.6,1.2,0);
character.add(leftArmGroup);
character.leftArm=leftArmGroup;

var rightArmGroup=new THREE.Group();
var rightArm=new THREE.Mesh(new THREE.DodecahedronGeometry(0.15,0),armMat);
rightArmGroup.add(rightArm);
var rightHand=new THREE.Mesh(new THREE.DodecahedronGeometry(0.1,0),new THREE.MeshToonMaterial({color:darkRockColor}));
rightHand.position.y=-0.25;
rightArmGroup.add(rightHand);
rightArmGroup.position.set(0.6,1.2,0);
character.add(rightArmGroup);
character.rightArm=rightArmGroup;

// 土の粒子
character.dirtParticles=[];
for(var i=0;i<10;i++){
var particle=new THREE.Mesh(
new THREE.BoxGeometry(0.03,0.03,0.03),
new THREE.MeshToonMaterial({color:darkRockColor,transparent:true,opacity:0.6})
);
var angle=Math.random()*Math.PI*2;
particle.position.set(
Math.sin(angle)*0.5,
0.2+Math.random()*0.5,
Math.cos(angle)*0.5
);
character.add(particle);
character.dirtParticles.push({mesh:particle,angle:angle,baseY:particle.position.y});
}

scene.add(character);
}
function createFloor(){
var floorGeo=new THREE.CircleGeometry(2,32);
var floorMat=new THREE.MeshToonMaterial({color:0xcac4bc});
var floor=new THREE.Mesh(floorGeo,floorMat);
floor.rotation.x=-Math.PI/2;
floor.position.y=0;
floor.receiveShadow=true;
scene.add(floor);
}
function animate(){
requestAnimationFrame(animate);
time+=0.03;
// ボディの微動
character.body.rotation.y=Math.sin(time*0.5)*0.1;
character.head.rotation.z=Math.sin(time*1)*0.05;
// 浮遊岩の周回
character.floatingRocks.forEach(function(r,i){
r.mesh.position.x=Math.sin(r.angle+time*0.5)*0.7;
r.mesh.position.z=Math.cos(r.angle+time*0.5)*0.7;
r.mesh.position.y=r.baseY+Math.sin(time*2+i)*0.1;
r.mesh.rotation.x+=0.02;
r.mesh.rotation.y+=0.03;
});
// クリスタルの発光感
character.crystals.forEach(function(c,i){
c.material.opacity=0.7+Math.sin(time*3+i)*0.15;
});
// 腕の動き
character.leftArm.rotation.z=Math.sin(time*1.2)*0.15;
character.rightArm.rotation.z=-Math.sin(time*1.2)*0.15;
// 土粒子
character.dirtParticles.forEach(function(p,i){
p.mesh.position.y=p.baseY+Math.sin(time*2+i)*0.15;
p.mesh.rotation.x+=0.02;
p.mesh.rotation.y+=0.03;
});
// 全体の浮遊（ゆっくり）
character.position.y=Math.sin(time*0.8)*0.05;
// 全体の回転
character.rotation.y=Math.sin(time*0.4)*0.2;
renderer.render(scene,camera);
}
init();
</script>
</body>
</html>
