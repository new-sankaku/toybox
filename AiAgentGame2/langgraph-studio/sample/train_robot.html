<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>機関車型ロボット</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:#d8d0c8;display:flex;justify-content:center;align-items:center;min-height:100vh;font-family:sans-serif;}
.container{background:#fff;border-radius:20px;padding:30px;box-shadow:0 10px 40px rgba(0,0,0,0.08);}
h2{text-align:center;color:#8b8178;margin-bottom:15px;font-weight:normal;font-size:18px;}
#canvas{display:block;border-radius:12px;}
</style>
</head>
<body>
<div class="container">
<h2>機関車型ロボット</h2>
<canvas id="canvas" width="400" height="400"></canvas>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
var scene,camera,renderer,robot,time=0;
function init(){
scene=new THREE.Scene();
scene.background=new THREE.Color(0xd8d0c8);
camera=new THREE.PerspectiveCamera(50,1,0.1,1000);
camera.position.set(3,2,5);
camera.lookAt(0,0.8,0);
renderer=new THREE.WebGLRenderer({canvas:document.getElementById('canvas'),antialias:true});
renderer.setSize(400,400);
renderer.shadowMap.enabled=true;
renderer.shadowMap.type=THREE.PCFSoftShadowMap;
var ambLight=new THREE.AmbientLight(0xffffff,0.6);
scene.add(ambLight);
var dirLight=new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(5,10,5);
dirLight.castShadow=true;
dirLight.shadow.mapSize.width=1024;
dirLight.shadow.mapSize.height=1024;
scene.add(dirLight);
createRobot();
createFloor();
animate();
}
function createRobot(){
robot=new THREE.Group();
var bodyColor=0xb8aea4;
var accentColor=0x8a817a;
var eyeColor=0x4a443e;
var cheekColor=0xc9a99c;
var darkColor=0x6a635c;

// メインボイラー（円筒形）
var boilerGeo=new THREE.CylinderGeometry(0.45,0.45,1.4,32);
var boilerMat=new THREE.MeshToonMaterial({color:bodyColor});
var boiler=new THREE.Mesh(boilerGeo,boilerMat);
boiler.rotation.x=Math.PI/2;
boiler.position.set(0,0.9,0);
boiler.castShadow=true;
robot.add(boiler);
robot.boiler=boiler;

// ボイラーリング
var ringGeo=new THREE.TorusGeometry(0.48,0.04,8,32);
var ringMat=new THREE.MeshToonMaterial({color:accentColor});
[-0.5,0,0.5].forEach(function(z){
var ring=new THREE.Mesh(ringGeo,ringMat);
ring.position.set(0,0.9,z);
robot.add(ring);
});

// 煙突
var chimneyGeo=new THREE.CylinderGeometry(0.12,0.15,0.5,16);
var chimneyMat=new THREE.MeshToonMaterial({color:accentColor});
var chimney=new THREE.Mesh(chimneyGeo,chimneyMat);
chimney.position.set(0,1.55,0.4);
robot.add(chimney);

var chimneyTop=new THREE.Mesh(new THREE.CylinderGeometry(0.18,0.12,0.1,16),chimneyMat);
chimneyTop.position.set(0,1.85,0.4);
robot.add(chimneyTop);

// 運転室（顔部分）
var cabGeo=new THREE.BoxGeometry(0.9,0.7,0.5);
var cabMat=new THREE.MeshToonMaterial({color:bodyColor});
var cab=new THREE.Mesh(cabGeo,cabMat);
cab.position.set(0,1.1,-0.75);
cab.castShadow=true;
robot.add(cab);
robot.cab=cab;

// 運転室屋根
var roofGeo=new THREE.BoxGeometry(1,0.08,0.6);
var roofMat=new THREE.MeshToonMaterial({color:accentColor});
var roof=new THREE.Mesh(roofGeo,roofMat);
roof.position.set(0,1.5,-0.75);
robot.add(roof);

// 顔（前面）
var faceGeo=new THREE.SphereGeometry(0.5,32,16,0,Math.PI*2,0,Math.PI/2);
var faceMat=new THREE.MeshToonMaterial({color:bodyColor});
var face=new THREE.Mesh(faceGeo,faceMat);
face.rotation.x=-Math.PI/2;
face.position.set(0,0.9,0.7);
robot.add(face);

// 目
var eyeGeo=new THREE.SphereGeometry(0.12,16,16);
var eyeMat=new THREE.MeshToonMaterial({color:eyeColor});
var leftEye=new THREE.Mesh(eyeGeo,eyeMat);
leftEye.position.set(-0.2,1,1);
robot.add(leftEye);
var rightEye=new THREE.Mesh(eyeGeo,eyeMat);
rightEye.position.set(0.2,1,1);
robot.add(rightEye);

// 瞳
var pupilGeo=new THREE.SphereGeometry(0.05,10,10);
var pupilMat=new THREE.MeshToonMaterial({color:0x2a2520});
var leftPupil=new THREE.Mesh(pupilGeo,pupilMat);
leftPupil.position.set(-0.2,1,1.12);
robot.add(leftPupil);
var rightPupil=new THREE.Mesh(pupilGeo,pupilMat);
rightPupil.position.set(0.2,1,1.12);
robot.add(rightPupil);

// 頬
var cheekGeo=new THREE.SphereGeometry(0.08,12,12);
var cheekMat=new THREE.MeshToonMaterial({color:cheekColor});
var leftCheek=new THREE.Mesh(cheekGeo,cheekMat);
leftCheek.position.set(-0.35,0.85,0.9);
leftCheek.scale.set(1,0.6,0.5);
robot.add(leftCheek);
var rightCheek=new THREE.Mesh(cheekGeo,cheekMat);
rightCheek.position.set(0.35,0.85,0.9);
rightCheek.scale.set(1,0.6,0.5);
robot.add(rightCheek);

// ヘッドライト
var lightGeo=new THREE.SphereGeometry(0.1,12,12);
var lightMat=new THREE.MeshToonMaterial({color:cheekColor,transparent:true,opacity:0.9});
var headlight=new THREE.Mesh(lightGeo,lightMat);
headlight.position.set(0,1.25,1.05);
robot.add(headlight);
robot.headlight=headlight;

// カウキャッチャー（前面の三角形）
var cowGeo=new THREE.BoxGeometry(0.8,0.15,0.25);
var cowMat=new THREE.MeshToonMaterial({color:darkColor});
var cowcatcher=new THREE.Mesh(cowGeo,cowMat);
cowcatcher.position.set(0,0.35,1);
robot.add(cowcatcher);

// 車輪（6輪）
robot.wheels=[];
var wheelGeo=new THREE.CylinderGeometry(0.25,0.25,0.1,24);
var wheelMat=new THREE.MeshToonMaterial({color:darkColor});
var wheelRimGeo=new THREE.TorusGeometry(0.25,0.03,8,24);
var wheelRimMat=new THREE.MeshToonMaterial({color:accentColor});

var wheelPositions=[
{x:-0.55,z:0.5},{x:0.55,z:0.5},
{x:-0.55,z:0},{x:0.55,z:0},
{x:-0.55,z:-0.5},{x:0.55,z:-0.5}
];
wheelPositions.forEach(function(pos){
var wheelGroup=new THREE.Group();
var wheel=new THREE.Mesh(wheelGeo,wheelMat);
wheel.rotation.z=Math.PI/2;
wheelGroup.add(wheel);
var rim=new THREE.Mesh(wheelRimGeo,wheelRimMat);
rim.rotation.y=Math.PI/2;
wheelGroup.add(rim);
// スポーク
for(var i=0;i<4;i++){
var spoke=new THREE.Mesh(new THREE.CylinderGeometry(0.02,0.02,0.4,6),wheelRimMat);
spoke.rotation.z=Math.PI/2+i*Math.PI/4;
wheelGroup.add(spoke);
}
wheelGroup.position.set(pos.x,0.25,pos.z);
robot.add(wheelGroup);
robot.wheels.push(wheelGroup);
});

// 連結棒（ロッド）
var rodGeo=new THREE.CylinderGeometry(0.03,0.03,1,8);
var rodMat=new THREE.MeshToonMaterial({color:accentColor});
var leftRod=new THREE.Mesh(rodGeo,rodMat);
leftRod.rotation.x=Math.PI/2;
leftRod.position.set(-0.55,0.25,0);
robot.add(leftRod);
var rightRod=new THREE.Mesh(rodGeo,rodMat);
rightRod.rotation.x=Math.PI/2;
rightRod.position.set(0.55,0.25,0);
robot.add(rightRod);

// 蒸気エフェクト（煙突上）
var steamGeo=new THREE.SphereGeometry(0.08,10,10);
var steamMat=new THREE.MeshToonMaterial({color:0xd8d0c8,transparent:true,opacity:0.6});
robot.steamPuffs=[];
for(var i=0;i<3;i++){
var steam=new THREE.Mesh(steamGeo,steamMat.clone());
steam.position.set(0,2+i*0.2,0.4);
steam.scale.set(1+i*0.3,1+i*0.3,1+i*0.3);
robot.add(steam);
robot.steamPuffs.push(steam);
}

scene.add(robot);
}
function createFloor(){
var floorGeo=new THREE.CircleGeometry(3,32);
var floorMat=new THREE.MeshToonMaterial({color:0xcac4bc});
var floor=new THREE.Mesh(floorGeo,floorMat);
floor.rotation.x=-Math.PI/2;
floor.position.y=0;
floor.receiveShadow=true;
scene.add(floor);
}
function animate(){
requestAnimationFrame(animate);
time+=0.03;
// ボディの振動
robot.boiler.position.y=0.9+Math.sin(time*8)*0.01;
robot.cab.position.y=1.1+Math.sin(time*8)*0.01;
// 車輪の回転
robot.wheels.forEach(function(wheel){
wheel.children[0].rotation.x+=0.1;
});
// 蒸気の上昇
robot.steamPuffs.forEach(function(steam,i){
steam.position.y=2+i*0.2+((time*0.5+i*0.3)%1)*0.5;
steam.material.opacity=0.6-((time*0.5+i*0.3)%1)*0.5;
steam.scale.setScalar(1+i*0.3+((time*0.5+i*0.3)%1)*0.5);
});
// ヘッドライト点滅
var brightness=0.7+Math.sin(time*2)*0.2;
robot.headlight.material.opacity=brightness;
// 全体の回転
robot.rotation.y=Math.sin(time*0.5)*0.25;
renderer.render(scene,camera);
}
init();
</script>
</body>
</html>
