# WebUI Design Specification

## NieR:Automata Inspired Design System

本ドキュメントはLangGraph Game Development SystemのためのNieR:Automata風UIデザインシステムを定義する。

**Reference Implementation**: `sample_webui/index.html`

---

## 1. Design Philosophy

### 1.1 Core Principles

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│    "美しさは機能に従う。すべての要素に意味がある。"              │
│                                                                 │
│    - Minimalism: 不要な装飾を排除                               │
│    - Geometry: 直線・グリッドによる構成                         │
│    - Warm Monochrome: ベージュ/セピアを基調                     │
│    - Machine: 機械的・アンドロイド的な美学                      │
│    - Category Colors: 状態を色で即座に識別                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 Visual Identity

NieR:Automataの特徴的なUI要素：
- **明るいベージュ背景**: `#E8E4D4` を基調とした温かみのある色
- **ダークヘッダー/フッター**: `#57534A` のコントラスト
- **カテゴリマーカー**: 4px縦線で状態を色分け
- **ダイヤモンドマーカー**: `◇` によるセクション区切り
- **広い字間**: letter-spacing 0.1em以上
- **角ばったデザイン**: border-radius: 0

---

## 2. Color System

### 2.1 Primary Palette (Source: index.html)

```css
:root {
  /* ===== Background Colors ===== */
  --bg-main: #E8E4D4;        /* メイン背景 */
  --bg-panel: #DAD5C3;       /* パネル背景 */
  --bg-selected: #CCC7B5;    /* 選択状態 */
  --bg-header: #57534A;      /* ヘッダー/フッター */
  --bg-footer: #57534A;

  /* ===== Text Colors ===== */
  --text-main: #454138;      /* メインテキスト */
  --text-light: #7A756A;     /* サブテキスト */
  --text-header: #E8E4D4;    /* ヘッダー内テキスト */
  --text-footer: #E8E4D4;    /* フッター内テキスト */

  /* ===== Accent Colors (Category Markers) ===== */
  --accent-red: #B85C5C;     /* システム/エラー/Critical */
  --accent-orange: #C4956C;  /* 実行中/Warning */
  --accent-yellow: #C9C078;  /* 待機中/Pending */
  --accent-green: #7AAA7A;   /* 完了/Success */
  --accent-blue: #6B8FAA;    /* 情報/Info */

  /* ===== Borders ===== */
  --border-light: rgba(69, 65, 56, 0.2);
  --border-dark: rgba(69, 65, 56, 0.4);
}
```

### 2.2 Color Usage Matrix

| 用途 | カラー | CSS変数 |
|------|--------|---------|
| メイン背景 | `#E8E4D4` | `--bg-main` |
| パネル背景 | `#DAD5C3` | `--bg-panel` |
| 選択状態 | `#CCC7B5` | `--bg-selected` |
| ヘッダー/フッター | `#57534A` | `--bg-header` |
| メインテキスト | `#454138` | `--text-main` |
| サブテキスト | `#7A756A` | `--text-light` |
| ヘッダー/フッターテキスト | `#E8E4D4` | `--text-header` |

### 2.3 Category Color System

```
┌─────────────────────────────────────────────────────────────────┐
│  CATEGORY MARKERS - 状態を示す4px縦線                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ██  --accent-red     #B85C5C   システム/エラー/Critical        │
│  ██  --accent-orange  #C4956C   実行中/Warning/進行中           │
│  ██  --accent-yellow  #C9C078   待機中/Pending/Human待ち        │
│  ██  --accent-green   #7AAA7A   完了/Success/承認済み           │
│  ██  --accent-blue    #6B8FAA   情報/Info/参照                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 2.4 Surface Classes（サーフェスクラス）

背景色と文字色の組み合わせミスを防ぐため、以下のサーフェスクラスを使用する。

```css
/* 背景と文字色をペアにしたクラス */
.nier-surface-main     { /* メイン背景 + メインテキスト */ }
.nier-surface-panel    { /* パネル背景 + メインテキスト */ }
.nier-surface-header   { /* ヘッダー背景 + 明るいテキスト */ }
.nier-surface-footer   { /* フッター背景 + 明るいテキスト */ }
.nier-surface-selected { /* 選択背景 + メインテキスト */ }
```

**使用ルール:**
1. UIコンポーネント（Card, Button等）を優先的に使用
2. 直接divを使う場合は `.nier-surface-*` を使用
3. `bg-*` と `text-*` を直接組み合わせない

```
┌─────────────────────────────────────────────────────────────────┐
│  SURFACE MATRIX                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  クラス                  背景          文字          用途       │
│  ───────────────────────────────────────────────────────────── │
│  nier-surface-main      #E8E4D4       #454138       メイン領域  │
│  nier-surface-panel     #DAD5C3       #454138       パネル/カード│
│  nier-surface-header    #57534A       #E8E4D4       ヘッダー    │
│  nier-surface-footer    #57534A       #E8E4D4       フッター    │
│  nier-surface-selected  #CCC7B5       #454138       選択状態    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. Typography

### 3.1 Font Stack

```css
/* Primary Font */
font-family: 'Noto Sans JP', sans-serif;
font-weight: 300;  /* Light - 本文 */
font-weight: 400;  /* Regular - 見出し */
font-weight: 500;  /* Medium - 強調 */

/* Letter Spacing */
letter-spacing: 0.1em;   /* 標準 */
letter-spacing: 0.15em;  /* 見出し */
```

### 3.2 Type Scale

| レベル | サイズ | 用途 |
|--------|--------|------|
| Display | 28px | ページタイトル |
| H1 | 20px | セクション見出し |
| H2 | 16px | カード見出し |
| Body | 14px | 本文 |
| Small | 13px | サブ情報 |
| Caption | 12px | ラベル、タイムスタンプ |

---

## 4. Layout Structure

### 4.1 Overall Layout

```
┌─────────────────────────────────────────────────────────────────┐
│  HEADER TABS (--bg-header)                                      │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐                     │
│  │MAP │ │QUEST│ │SYS │ │AGT │ │LOG │ │DATA│                     │
│  └────┘ └────┘ └────┘ └────┘ └────┘ └────┘                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  MAIN CONTENT (--bg-main)                                       │
│  ┌──────────────────┐  ┌──────────────────────────────────────┐ │
│  │                  │  │                                      │ │
│  │   LEFT PANEL     │  │          RIGHT PANEL                 │ │
│  │   (List View)    │  │          (Detail View)               │ │
│  │                  │  │                                      │ │
│  │   width: 320px   │  │          flex: 1                     │ │
│  │                  │  │                                      │ │
│  └──────────────────┘  └──────────────────────────────────────┘ │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  FOOTER (--bg-footer)                                           │
│  メッセージ                              操作ガイド             │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 Header Tabs

```css
.header-tabs {
  display: flex;
  background: var(--bg-header);
  border-bottom: 2px solid #3D3A33;
}

.tab {
  padding: 12px 24px;
  color: var(--text-header);
  font-size: 13px;
  letter-spacing: 0.1em;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  border-right: 1px solid rgba(255,255,255,0.1);
}

.tab:hover {
  background: rgba(255,255,255,0.1);
}

.tab.active {
  background: rgba(255,255,255,0.15);
}
```

### 4.3 Diamond Marker

```css
.diamond-marker {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  color: var(--text-light);
  font-size: 12px;
}

.diamond-marker::before {
  content: '◇';
  font-size: 14px;
}
```

---

## 5. Component Design

### 5.1 Panel / Card

```
┌─────────────────────────────────────────────────────────────────┐
│  DETAIL CARD                                                    │
├─────────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  HEADER (--bg-header, --text-header)                       │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │  BODY (--bg-panel)                                        │  │
│  │                                                           │  │
│  │  Content goes here...                                     │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  CSS:                                                           │
│  - background: var(--bg-panel)                                 │
│  - border: 1px solid var(--border-light)                       │
│  - border-radius: 0                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 List Item with Category Marker

```
┌─────────────────────────────────────────────────────────────────┐
│  LIST ITEM                                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─┬──────────────────────────────────────────────────────┬──┐  │
│  │▌│  Item Name                                           │67%│  │
│  └─┴──────────────────────────────────────────────────────┴──┘  │
│   ↑                                                              │
│   Category Marker (4px width, 16px height)                      │
│                                                                 │
│  CSS:                                                           │
│  .category-marker {                                             │
│    width: 4px;                                                  │
│    height: 16px;                                                │
│  }                                                              │
│  .category-marker.running { background: var(--accent-orange); } │
│  .category-marker.pending { background: var(--accent-yellow); } │
│  .category-marker.complete { background: var(--accent-green); } │
│  .category-marker.error { background: var(--accent-red); }      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.3 Progress Bar

```css
.progress-bar {
  height: 8px;
  background: var(--border-light);
}

.progress-fill {
  height: 100%;
  background: var(--text-main);
  transition: width 0.3s ease;
}
```

### 5.4 Status Row

```
┌─────────────────────────────────────────────────────────────────┐
│  STATUS DISPLAY                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ ステータス                                                │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │ プロジェクト：                        Untitled RPG        │  │
│  │ ─────────────────────────────────────────────────────────│  │
│  │ フェーズ：                      Phase 2 - Development    │  │
│  │ ─────────────────────────────────────────────────────────│  │
│  │ 実行時間：                                    00:45:23   │  │
│  │ ─────────────────────────────────────────────────────────│  │
│  │ タスク完了：                                    12 / 28   │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.5 Checkpoint Alert Card

```
┌─────────────────────────────────────────────────────────────────┐
│  CHECKPOINT CARD (承認待ち)                                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◈ CHECKPOINT - 承認待ち          (--accent-red背景)      │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │  種別：                      Design Document Review       │  │
│  │  待機時間：                              1h 23m (赤文字)   │  │
│  │                                                           │  │
│  │  ┌─────────┐  ┌─────────────────┐  ┌─────────┐           │  │
│  │  │ APPROVE │  │ REQUEST CHANGES │  │ REJECT  │           │  │
│  │  └─────────┘  └─────────────────┘  └─────────┘           │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. Metrics Display

### 6.1 Agent Metrics Panel

```
┌─────────────────────────────────────────────────────────────────┐
│  AGENT METRICS                                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◇ 実行メトリクス                                         │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │  ■ 時間                                                   │  │
│  │    実行時間：                                  00:45:23   │  │
│  │    推定残り時間：                              00:32:00   │  │
│  │    推定終了時刻：                              15:17:23   │  │
│  │                                                           │  │
│  │  ■ トークン使用量                                         │  │
│  │    このAgent：                           12,450 tokens    │  │
│  │    プロジェクト累計：                    45,230 tokens    │  │
│  │    推定総トークン：                      78,000 tokens    │  │
│  │                                                           │  │
│  │  ■ 進捗                                                   │  │
│  │    完了タスク：                                  12 / 28   │  │
│  │    サブAgent：                               3 active     │  │
│  │                                                           │  │
│  │  ████████████████████░░░░░░░░░░░░░░░░░░░░  43%           │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 6.2 Task Queue Display

```
┌─────────────────────────────────────────────────────────────────┐
│  TASK QUEUE                                                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◇ タスク一覧                                             │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │  ■ 実行中 (3)                                             │  │
│  │  ┌─┬──────────────────────────────────────────────┬────┐  │  │
│  │  │▌│ PlayerController.ts                          │ 78%│  │  │
│  │  └─┴──────────────────────────────────────────────┴────┘  │  │
│  │  ┌─┬──────────────────────────────────────────────┬────┐  │  │
│  │  │▌│ GameState.ts                                 │ 45%│  │  │
│  │  └─┴──────────────────────────────────────────────┴────┘  │  │
│  │  ┌─┬──────────────────────────────────────────────┬────┐  │  │
│  │  │▌│ AssetLoader.ts                               │ 23%│  │  │
│  │  └─┴──────────────────────────────────────────────┴────┘  │  │
│  │                                                           │  │
│  │  ■ 待機中 (8)                                             │  │
│  │  ┌─┬──────────────────────────────────────────────┬────┐  │  │
│  │  │▌│ UIManager.ts                                 │ -- │  │  │
│  │  └─┴──────────────────────────────────────────────┴────┘  │  │
│  │  ┌─┬──────────────────────────────────────────────┬────┐  │  │
│  │  │▌│ SoundManager.ts                              │ -- │  │  │
│  │  └─┴──────────────────────────────────────────────┴────┘  │  │
│  │  ... (+6 more)                                            │  │
│  │                                                           │  │
│  │  ■ 完了 (12)                                              │  │
│  │  ┌─┬──────────────────────────────────────────────┬────┐  │  │
│  │  │▌│ main.ts                                      │ ✓  │  │  │
│  │  └─┴──────────────────────────────────────────────┴────┘  │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 7. Output Viewer

### 7.1 Document Viewer (Concept/Design)

```
┌─────────────────────────────────────────────────────────────────┐
│  DOCUMENT VIEWER                                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◇ Concept Document                    [RAW] [PREVIEW]    │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │  # ゲームコンセプト                                       │  │
│  │                                                           │  │
│  │  ## タイトル                                              │  │
│  │  Untitled RPG                                             │  │
│  │                                                           │  │
│  │  ## ジャンル                                              │  │
│  │  2D アクションRPG                                         │  │
│  │                                                           │  │
│  │  ## コアループ                                            │  │
│  │  探索 → 戦闘 → 成長 → 探索...                             │  │
│  │                                                           │  │
│  │  ## ターゲットプラットフォーム                            │  │
│  │  Web Browser                                              │  │
│  │                                                           │  │
│  │  ─────────────────────────────────────────────────────── │  │
│  │  Agent: ConceptAgent                                      │  │
│  │  Generated: 2024-01-15 14:23:00                          │  │
│  │  Tokens used: 2,847                                       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  View modes:                                                    │
│  - [PREVIEW]: Markdown rendered                                │
│  - [RAW]: JSON/Plain text                                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 7.2 Code Viewer

```
┌─────────────────────────────────────────────────────────────────┐
│  CODE VIEWER (Syntax Highlighted)                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◇ PlayerController.ts                     [COPY] [DIFF]  │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │   1 │ import { Entity } from './Entity';                  │  │
│  │   2 │ import { Input } from './Input';                    │  │
│  │   3 │                                                     │  │
│  │   4 │ export class PlayerController extends Entity {      │  │
│  │   5 │   private velocity = { x: 0, y: 0 };               │  │
│  │   6 │   private speed = 200;                             │  │
│  │   7 │                                                     │  │
│  │   8 │   update(dt: number): void {                       │  │
│  │   9 │     const input = Input.getAxis();                 │  │
│  │  10 │     this.velocity.x = input.x * this.speed;        │  │
│  │  11 │     this.velocity.y = input.y * this.speed;        │  │
│  │  12 │     this.x += this.velocity.x * dt;                │  │
│  │  13 │     this.y += this.velocity.y * dt;                │  │
│  │  14 │   }                                                 │  │
│  │  15 │ }                                                   │  │
│  │                                                           │  │
│  │  ─────────────────────────────────────────────────────── │  │
│  │  Lines: 15  |  Language: TypeScript                       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  Features:                                                      │
│  - Syntax highlighting (Prism.js / highlight.js)               │
│  - Line numbers                                                 │
│  - Copy to clipboard                                           │
│  - Diff view (変更箇所のハイライト)                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 7.3 Asset Viewer

```
┌─────────────────────────────────────────────────────────────────┐
│  ASSET VIEWER                                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ■ Image Preview                                                │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◇ player_idle.png                        [DOWNLOAD]      │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │         ┌─────────────────────────────────┐               │  │
│  │         │                                 │               │  │
│  │         │       [Image Preview]           │               │  │
│  │         │         64x64 px                │               │  │
│  │         │                                 │               │  │
│  │         └─────────────────────────────────┘               │  │
│  │                                                           │  │
│  │  Size: 2.4 KB  |  Format: PNG  |  Dimensions: 64x64      │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ■ Audio Preview                                                │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◇ bgm_main.mp3                           [DOWNLOAD]      │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │    ▶ ━━━━━━━━━━━━━━━━○━━━━━━━━━━━━━━━━━━   02:34 / 04:12  │  │
│  │                                                           │  │
│  │  Size: 3.2 MB  |  Format: MP3  |  Bitrate: 192kbps       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 7.4 Test Results Viewer

```
┌─────────────────────────────────────────────────────────────────┐
│  TEST RESULTS VIEWER                                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◇ テスト結果サマリー                                     │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │  Pass Rate: ████████████████████████░░░░  85%            │  │
│  │                                                           │  │
│  │  ┌────────────┬────────┬────────┬────────┐               │  │
│  │  │            │ Passed │ Failed │ Skip   │               │  │
│  │  ├────────────┼────────┼────────┼────────┤               │  │
│  │  │ Unit       │   118  │    2   │   0    │               │  │
│  │  │ Integration│    20  │    0   │   0    │               │  │
│  │  │ E2E        │    14  │    1   │   0    │               │  │
│  │  └────────────┴────────┴────────┴────────┘               │  │
│  │                                                           │  │
│  │  ■ 失敗テスト詳細                                         │  │
│  │  ┌─┬──────────────────────────────────────────────────┐  │  │
│  │  │▌│ InventorySystem.test.ts:45                       │  │  │
│  │  │ │ Expected 10 but received 11                      │  │  │
│  │  └─┴──────────────────────────────────────────────────┘  │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 8. Error Handling UI

### 8.1 Error Categories

```
┌─────────────────────────────────────────────────────────────────┐
│  ERROR CATEGORIES                                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. CONNECTION ERRORS (接続エラー)                              │
│     - WebSocket切断                                             │
│     - サーバー接続失敗                                          │
│     - ネットワークタイムアウト                                  │
│                                                                 │
│  2. LLM ERRORS (LLMエラー)                                      │
│     - API呼び出し失敗                                           │
│     - レート制限                                                │
│     - トークン上限超過                                          │
│     - 不正なレスポンス                                          │
│                                                                 │
│  3. AGENT ERRORS (Agentエラー)                                  │
│     - タスク実行失敗                                            │
│     - 依存関係エラー                                            │
│     - タイムアウト                                              │
│     - 出力バリデーションエラー                                  │
│                                                                 │
│  4. STATE ERRORS (状態エラー)                                   │
│     - 状態同期失敗                                              │
│     - チェックポイント保存失敗                                  │
│     - 状態復元失敗                                              │
│                                                                 │
│  5. USER ERRORS (ユーザーエラー)                                │
│     - 入力バリデーションエラー                                  │
│     - 権限エラー                                                │
│     - リソース不足                                              │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.2 Error Display Components

```
┌─────────────────────────────────────────────────────────────────┐
│  INLINE ERROR (フィールドエラー)                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Game Concept                                                   │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  [Input with error border (--accent-red)]                 │  │
│  └───────────────────────────────────────────────────────────┘  │
│  ⚠ コンセプトは50文字以上で入力してください                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│  TOAST NOTIFICATION (一時通知)                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ▌ ⚠ 接続が切断されました。再接続中...               [×] │  │
│  └───────────────────────────────────────────────────────────┘  │
│    Category marker (--accent-orange)                            │
│                                                                 │
│  Duration: 5秒 (auto-dismiss) or 手動で閉じる                  │
│  Position: 画面右上                                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│  ERROR PANEL (詳細エラー)                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  ◈ ERROR - Agent実行失敗          (--accent-red背景)      │  │
│  ├───────────────────────────────────────────────────────────┤  │
│  │                                                           │  │
│  │  Agent：                                      CodeLeader  │  │
│  │  エラー種別：                              タイムアウト   │  │
│  │  発生時刻：                          2024-01-15 14:45:23  │  │
│  │                                                           │  │
│  │  ■ 詳細                                                   │  │
│  │  タスク「PlayerController.ts」の実行が                   │  │
│  │  制限時間（5分）を超過しました。                         │  │
│  │                                                           │  │
│  │  ■ 対処方法                                               │  │
│  │  • タスクを再実行する                                     │  │
│  │  • タスクをスキップして次へ進む                          │  │
│  │  • プロジェクトを一時停止する                            │  │
│  │                                                           │  │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐             │  │
│  │  │  再実行   │  │  スキップ │  │  停止     │             │  │
│  │  └───────────┘  └───────────┘  └───────────┘             │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.3 Connection Status Indicator

```
┌─────────────────────────────────────────────────────────────────┐
│  CONNECTION STATUS (常時表示 - ヘッダー右上)                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ● Connected              正常接続 (--accent-green)             │
│  ◐ Reconnecting...        再接続中 (--accent-orange, 点滅)      │
│  ○ Disconnected           切断 (--accent-red)                   │
│                                                                 │
│  Disconnected時のオーバーレイ:                                  │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                                                           │  │
│  │                   ◐ 再接続中...                           │  │
│  │                                                           │  │
│  │                 サーバーとの接続が                        │  │
│  │               切断されました。                            │  │
│  │                                                           │  │
│  │              再接続を試みています...                      │  │
│  │              (試行回数: 3/5)                              │  │
│  │                                                           │  │
│  │              ████████░░░░░░░░░░░░░░░░░░░░                 │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.4 Error Log in System Log

```
┌─────────────────────────────────────────────────────────────────┐
│  SYSTEM LOG WITH ERRORS                                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  14:45:01  [INFO ]  CodeLeader started task                    │
│  14:45:02  [DEBUG]  Loading dependencies...                    │
│  14:45:03  [WARN ]  Token usage high: 3,500/4,096              │
│  14:45:23  [ERROR]  Task timeout: PlayerController.ts          │
│            │        └─ Retry 1/3 scheduled                     │
│  14:45:24  [INFO ]  Retrying task...                           │
│  14:46:24  [ERROR]  Task timeout: PlayerController.ts          │
│            │        └─ Retry 2/3 scheduled                     │
│  14:47:24  [ERROR]  Task failed permanently                    │
│            │        └─ Human intervention required             │
│  14:47:25  [CHECKPOINT] Awaiting human decision               │
│                                                                 │
│  Color coding:                                                  │
│  - [INFO ]: var(--text-main)                                   │
│  - [DEBUG]: var(--text-light)                                  │
│  - [WARN ]: var(--accent-orange)                               │
│  - [ERROR]: var(--accent-red)                                  │
│  - [CHECKPOINT]: var(--accent-yellow)                          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 9. Resilience & Recovery

### 9.1 Connection Recovery Flow

```
┌─────────────────────────────────────────────────────────────────┐
│  CONNECTION RECOVERY FLOW                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌──────────────┐                                               │
│  │  接続中      │                                               │
│  └──────┬───────┘                                               │
│         │                                                       │
│         │ WebSocket切断検知                                     │
│         ▼                                                       │
│  ┌──────────────┐                                               │
│  │  再接続試行  │◄──────────────────────────────┐               │
│  │  (自動)      │                              │               │
│  └──────┬───────┘                              │               │
│         │                                      │               │
│         ├─────────┐                            │               │
│         ▼         │                            │               │
│  ┌──────────────┐ │ 失敗                       │               │
│  │  成功?       │─┤                            │               │
│  └──────┬───────┘ │                            │               │
│         │         ▼                            │               │
│         │  ┌──────────────┐                    │               │
│         │  │  Wait        │  Exponential       │               │
│         │  │  (1s→2s→4s)  │  Backoff           │               │
│         │  └──────┬───────┘                    │               │
│         │         │                            │               │
│         │         │ 5回失敗                    │               │
│         │         ▼                            │               │
│         │  ┌──────────────┐                    │               │
│         │  │  手動再接続  │  ユーザーに        │               │
│         │  │  ボタン表示  │  操作を委ねる      │               │
│         │  └──────┬───────┘                    │               │
│         │         │                            │               │
│         │         │ ユーザークリック          │               │
│         │         └────────────────────────────┘               │
│         │                                                       │
│         │ 成功                                                  │
│         ▼                                                       │
│  ┌──────────────┐                                               │
│  │  状態同期    │  最新状態をサーバーから取得                   │
│  └──────┬───────┘                                               │
│         │                                                       │
│         ▼                                                       │
│  ┌──────────────┐                                               │
│  │  正常動作    │                                               │
│  └──────────────┘                                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 9.2 State Persistence Display

```
┌─────────────────────────────────────────────────────────────────┐
│  STATE PERSISTENCE INDICATOR                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  フッター左側に常時表示:                                        │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ ▌ 最終保存: 14:45:23 (30秒前)  │  ◉ 自動保存: ON       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  保存状態:                                                      │
│  - ◉ 保存済み (--accent-green)                                 │
│  - ◐ 保存中... (--accent-orange, 回転アニメーション)           │
│  - ⚠ 保存失敗 (--accent-red)                                   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 9.3 Recovery Options Modal

```
┌─────────────────────────────────────────────────────────────────┐
│  RECOVERY OPTIONS (接続復旧後)                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                                                           │  │
│  │  ◈ 接続が復旧しました                                     │  │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │  │
│  │                                                           │  │
│  │  切断中にサーバー側で処理が進行していました。             │  │
│  │                                                           │  │
│  │  ■ サーバー状態                                           │  │
│  │    現在のAgent: CodeLeader (78%)                          │  │
│  │    完了タスク: 15 / 28                                    │  │
│  │                                                           │  │
│  │  ■ ローカル状態                                           │  │
│  │    最終同期: CodeLeader (45%)                             │  │
│  │    完了タスク: 12 / 28                                    │  │
│  │                                                           │  │
│  │  ┌─────────────────────────────────────────────────────┐  │  │
│  │  │          サーバー状態に同期する（推奨）            │  │  │
│  │  └─────────────────────────────────────────────────────┘  │  │
│  │                                                           │  │
│  │  ┌─────────────────────────────────────────────────────┐  │  │
│  │  │              差分を確認する                        │  │  │
│  │  └─────────────────────────────────────────────────────┘  │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 10. Page Layouts

### 10.1 Dashboard (Main View)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  MAP   QUEST   SYSTEM   AGENTS   LOGS   DATA            ● Connected        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  SYSTEM - プロジェクト概要                                                  │
│                                                                             │
│  ┌──────────────────────────────┐  ┌──────────────────────────────────────┐ │
│  │ ◇ プロジェクト               │  │ ◇ フェーズ進捗                       │ │
│  ├──────────────────────────────┤  ├──────────────────────────────────────┤ │
│  │                              │  │                                      │ │
│  │ Untitled RPG                 │  │ ●━━━●━━━◐━━━○━━━○━━━○               │ │
│  │ Phase 2 - Development        │  │ P1   P1   P2   P2   P3   P3          │ │
│  │ 実行時間: 00:45:23           │  │                                      │ │
│  │                              │  │ 現在: Code Leader (43%)              │ │
│  └──────────────────────────────┘  └──────────────────────────────────────┘ │
│                                                                             │
│  ┌──────────────────────────────┐  ┌──────────────────────────────────────┐ │
│  │ ◇ メトリクス                 │  │ ◇ 承認待ち (2)                       │ │
│  ├──────────────────────────────┤  ├──────────────────────────────────────┤ │
│  │                              │  │                                      │ │
│  │ トークン使用: 45,230         │  │ ┌─┬────────────────────────┬──────┐ │ │
│  │ 推定総トークン: 78,000       │  │ │▌│ Design Document Review │ 1h23m│ │ │
│  │ 推定終了: 15:17:23           │  │ └─┴────────────────────────┴──────┘ │ │
│  │                              │  │ ┌─┬────────────────────────┬──────┐ │ │
│  │ タスク: 12/28 完了           │  │ │▌│ Character Designs      │  45m │ │ │
│  │ ████████████░░░░░░░░ 43%     │  │ └─┴────────────────────────┴──────┘ │ │
│  │                              │  │                                      │ │
│  └──────────────────────────────┘  └──────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │ ◇ アクティブAgent                                                       ││
│  ├─────────────────────────────────────────────────────────────────────────┤│
│  │ ┌─┬──────────────┬─────┐ ┌─┬──────────────┬─────┐ ┌─┬─────────┬─────┐  ││
│  │ │▌│ CodeLeader   │ 67% │ │▌│ AssetLeader  │ 45% │ │▌│ Tester  │ --  │  ││
│  │ └─┴──────────────┴─────┘ └─┴──────────────┴─────┘ └─┴─────────┴─────┘  ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│ ▌ 最終保存: 14:45:23                                     ↕ 選択  ◉ 決定  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 10.2 Agent Detail View

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  MAP   QUEST   SYSTEM   AGENTS   LOGS   DATA            ● Connected        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ← 戻る                                                                     │
│                                                                             │
│  AGENTS - CodeLeader                                                        │
│                                                                             │
│  ┌──────────────────┐  ┌────────────────────────────────────────────────┐   │
│  │                  │  │ ◇ ステータス                                   │   │
│  │    ┌──────────┐  │  ├────────────────────────────────────────────────┤   │
│  │    │    ◈     │  │  │ Status:        ◉ RUNNING                      │   │
│  │    │          │  │  │ Runtime:       00:45:23                        │   │
│  │    │   67%    │  │  │ Tasks:         12/28 complete                  │   │
│  │    └──────────┘  │  │ Sub-agents:    3 active                        │   │
│  │                  │  │                                                │   │
│  │   CODE LEADER    │  │ ■ トークン使用                                 │   │
│  │                  │  │   このAgent:    12,450 tokens                  │   │
│  │                  │  │   累計:         45,230 tokens                  │   │
│  │                  │  │                                                │   │
│  └──────────────────┘  │ ■ 時間                                         │   │
│                        │   推定残り:     00:32:00                       │   │
│                        │   推定終了:     15:17:23                       │   │
│                        └────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌──────────────────────────────┐  ┌──────────────────────────────────────┐ │
│  │ ◇ 現在のタスク               │  │ ◇ サブAgent                          │ │
│  ├──────────────────────────────┤  ├──────────────────────────────────────┤ │
│  │                              │  │                                      │ │
│  │ UI Components実装            │  │ ┌─┬──────────────────────┬─────┐    │ │
│  │                              │  │ │▌│ CodeWorker #1        │ 78% │    │ │
│  │ ████████████░░░░░░░░ 60%     │  │ │ │ PlayerController.ts  │     │    │ │
│  │                              │  │ └─┴──────────────────────┴─────┘    │ │
│  │ Files:                       │  │ ┌─┬──────────────────────┬─────┐    │ │
│  │ - src/ui/Menu.tsx           │  │ │▌│ CodeWorker #2        │ 45% │    │ │
│  │ - src/ui/Button.tsx         │  │ │ │ GameState.ts         │     │    │ │
│  │ - src/ui/styles.css         │  │ └─┴──────────────────────┴─────┘    │ │
│  │                              │  │ ┌─┬──────────────────────┬─────┐    │ │
│  └──────────────────────────────┘  │ │▌│ CodeWorker #3        │ 23% │    │ │
│                                    │ │ │ AssetLoader.ts       │     │    │ │
│                                    │ └─┴──────────────────────┴─────┘    │ │
│                                    └──────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │ ◇ Agentログ                                              [Filter ▾]    ││
│  ├─────────────────────────────────────────────────────────────────────────┤│
│  │ 14:45:23  [INFO ]  Starting task: UI Components                        ││
│  │ 14:45:24  [INFO ]  Spawning CodeWorker for PlayerController            ││
│  │ 14:45:25  [DEBUG]  Analyzing dependencies...                           ││
│  │ 14:46:01  [INFO ]  CodeWorker #1 progress: 25%                         ││
│  │ ▌                                                                       ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│ ▌ 最終保存: 14:45:23                                     ↕ 選択  ◉ 決定  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 10.3 Human Checkpoint Review

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  MAP   QUEST   SYSTEM   AGENTS   LOGS   DATA            ● Connected        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ◈ CHECKPOINT - Design Document Review                                      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                                             │
│  Agent: DesignAgent                                                         │
│  Phase: 1 - Planning                                                        │
│  Submitted: 2024-01-15 14:23:00                                            │
│  Waiting: 1h 23m                                                            │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │ ◇ 出力プレビュー                                      [RAW] [PREVIEW] ││
│  ├─────────────────────────────────────────────────────────────────────────┤│
│  │                                                                         ││
│  │ # Technical Design Document                                             ││
│  │                                                                         ││
│  │ ## Architecture Overview                                                ││
│  │ The game will use a component-based architecture with...                ││
│  │                                                                         ││
│  │ ## Technology Stack                                                     ││
│  │ - Engine: Phaser 3.60                                                   ││
│  │ - Language: TypeScript 5.0                                              ││
│  │ - Build: Vite 5.0                                                       ││
│  │                                                                         ││
│  │ ## Component Structure                                                  ││
│  │ - GameCore: Main game loop                                              ││
│  │ - EntityManager: Entity lifecycle                                       ││
│  │ - RenderSystem: Sprite rendering                                        ││
│  │                                                                         ││
│  │ [Show Full Document...]                                                 ││
│  │                                                                         ││
│  │ ─────────────────────────────────────────────────────────────────────  ││
│  │ Tokens used: 3,245  |  Generated in: 45.2s                              ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │ ◇ フィードバック                                                        ││
│  ├─────────────────────────────────────────────────────────────────────────┤│
│  │ ┌─────────────────────────────────────────────────────────────────────┐ ││
│  │ │                                                                     │ ││
│  │ │ フィードバックを入力...                                             │ ││
│  │ │                                                                     │ ││
│  │ └─────────────────────────────────────────────────────────────────────┘ ││
│  │                                                                         ││
│  │  ┌─────────────┐  ┌───────────────────┐  ┌─────────────┐               ││
│  │  │  ✓ APPROVE  │  │ ↻ REQUEST CHANGES │  │  ✕ REJECT   │               ││
│  │  └─────────────┘  └───────────────────┘  └─────────────┘               ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│ ▌ 最終保存: 14:45:23                                     ↕ 選択  ◉ 決定  │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 11. Animations & Transitions

### 11.1 Animation Timing

```css
/* Timing Functions */
--ease-smooth: cubic-bezier(0.4, 0.0, 0.2, 1);
--ease-decelerate: cubic-bezier(0.0, 0.0, 0.2, 1);
--ease-accelerate: cubic-bezier(0.4, 0.0, 1, 1);

/* Duration */
--duration-fast: 150ms;
--duration-normal: 300ms;
--duration-slow: 500ms;
```

### 11.2 Key Animations

| アニメーション | トリガー | 説明 |
|---------------|----------|------|
| Fade In | ページ読み込み | 0.3秒フェード |
| Panel Slide | パネル開閉 | 左/右からスライド + フェード |
| Progress Fill | 進捗更新 | 滑らかなバー伸長 |
| Status Pulse | 実行中状態 | ゆっくりとした明滅 |
| Error Flash | エラー発生 | 0.1秒の赤点滅 |

---

## 12. Design Tokens Summary

```css
:root {
  /* ===== Colors ===== */
  --bg-main: #E8E4D4;
  --bg-panel: #DAD5C3;
  --bg-selected: #CCC7B5;
  --bg-header: #57534A;
  --bg-footer: #57534A;
  --text-main: #454138;
  --text-light: #7A756A;
  --text-header: #E8E4D4;
  --text-footer: #E8E4D4;
  --accent-red: #B85C5C;
  --accent-orange: #C4956C;
  --accent-yellow: #C9C078;
  --accent-green: #7AAA7A;
  --accent-blue: #6B8FAA;
  --border-light: rgba(69, 65, 56, 0.2);
  --border-dark: rgba(69, 65, 56, 0.4);

  /* ===== Typography ===== */
  --font-primary: 'Noto Sans JP', sans-serif;
  --font-weight-light: 300;
  --font-weight-regular: 400;
  --font-weight-medium: 500;
  --letter-spacing-normal: 0.1em;
  --letter-spacing-wide: 0.15em;

  /* ===== Spacing ===== */
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 16px;
  --space-lg: 24px;
  --space-xl: 32px;

  /* ===== Transitions ===== */
  --transition-fast: 150ms ease;
  --transition-normal: 300ms ease;
  --transition-slow: 500ms ease;

  /* ===== Z-Index ===== */
  --z-base: 0;
  --z-dropdown: 100;
  --z-modal: 200;
  --z-toast: 300;
  --z-tooltip: 400;
}
```

---

## Appendix: Asset Requirements

### Fonts
- Noto Sans JP (Google Fonts) - weight: 300, 400, 500

### Icons
- Diamond marker: `◇` (Unicode)
- Status indicators: `●` `◐` `○` `✓` `✕` `⚠`
- Tab icons: `⊞` `✦` `⚙` `⚔` `◈` `☰`
