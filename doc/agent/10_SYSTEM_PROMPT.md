# システムプロンプト

## 概要

Agentごとにシステムプロンプトを定義し、権限階層を明確にする。
システムプロンプトはユーザーメッセージより優先され、Agentの行動を強く制御する。

## 権限階層

| 優先度 | 内容 |
|-------|------|
| 1（最高） | システムプロンプト |
| 2 | ユーザーメッセージ（Human指示） |
| 3 | ツール結果（実行結果） |

矛盾が発生した場合、上位の指示が優先される。

## プロンプト構成

### 階層構造

| 順序 | 種類 | 説明 |
|------|------|------|
| 1 | ベースプロンプト | 全Agent共通 |
| 2 | ロールプロンプト | DIRECTOR/LEADER/WORKER |
| 3 | Phase固有プロンプト | Phase1/2/3 |
| 4 | Agent固有プロンプト | 具体的なAgent（Concept, Code等） |
| 5 | タスク固有コンテキスト | 動的生成 |

## ベースプロンプト（prompts/base.md）

### 絶対遵守事項

1. **単一責任**: 割り当てられたタスクのみを実行する
2. **スコープ厳守**: 指定されたファイル以外を変更しない
3. **品質優先**: 検証なしで完了としない
4. **透明性**: 判断理由を必ず明示する
5. **エスカレーション**: 判断に迷ったら上位に報告する

### 禁止事項

- 割り当てられていないタスクの実行
- 承認なしでの重要な設計変更
- エラーの隠蔽
- 不確実な情報の断定

## ロールプロンプト

### DIRECTOR（prompts/role/director.md）

| 項目 | 内容 |
|------|------|
| 責務 | LEADER管理、Phase内進捗監視、Phase完了報告 |
| 判断基準 | LEADERからの報告を精査、品質基準確認 |
| 権限 | LEADERへの指示、タスク優先度変更、問題のエスカレーション |

### LEADER（prompts/role/leader.md）

| 項目 | 内容 |
|------|------|
| 責務 | タスク分解、WORKER割当、成果物統合 |
| 判断基準 | タスクは必ず単一化、成果物は必ずレビュー |
| 権限 | WORKER生成・終了、タスク分解・割当、成果物マージ |

### WORKER（prompts/role/worker.md）

| 項目 | 内容 |
|------|------|
| 責務 | 単一タスク実行、成果物生成、完了報告 |
| 絶対遵守 | 割り当てタスクのみ実行、指定ファイルのみ変更 |
| 権限 | 指定ファイルの編集、必要ファイルの読み取り、LEADERへの報告 |

## Phase固有プロンプト

| Phase | 目的 | 成果物 |
|-------|------|-------|
| Phase1 | ゲームの企画・設計 | コンセプト、GDD、シナリオ、キャラ設定、世界観、タスク分解 |
| Phase2 | 企画に基づく実装 | ソースコード、アセット、テストコード |
| Phase3 | 成果物の品質確保 | テスト結果レポート、レビューコメント、修正済みコード |

## フォルダ構造

| パス | 内容 |
|------|------|
| prompts/base.md | ベースプロンプト |
| prompts/role/*.md | ロール別プロンプト |
| prompts/phase/*.md | Phase別プロンプト |
| prompts/agent/*.md | Agent別プロンプト |
