# UI/UX改善計画書

## 概要

本ドキュメントは、toyboxプロジェクトのUI/UX改善計画をまとめたものです。
中規模以上の改善案を優先度順に整理しています。

---

## 改善計画一覧

| # | 改善項目 | 規模 | 優先度 | 想定影響範囲 |
|---|----------|------|--------|-------------|
| 1 | 空状態（Empty State）システムの統一 | 中 | 高 | 全画面 |
| 2 | フォームUXの統一・改善 | 中 | 高 | ProjectView, ConfigView |
| 3 | Undo機能・ソフトデリートの実装 | 大 | 高 | 削除機能全般 |
| 4 | テーブル/リストの仮想スクロール対応 | 中 | 中 | DataView, LogsView, CheckpointsView |
| 5 | モーダル/パネルシステムの統一 | 中 | 中 | Modal, FloatingPanel使用箇所 |
| 6 | オンボーディング・ヘルプシステムの導入 | 大 | 低 | 全画面 |

---

## 1. 空状態（Empty State）システムの統一

### 現状の問題
- 画面ごとに空状態の表現がバラバラ
- 次のアクションへの導線がない画面がある
- 視覚的表現が弱い（アイコン+テキストのみ）

### 改善内容

#### 1-1. EmptyStateコンポーネントの作成
```tsx
interface EmptyStateProps {
  icon: LucideIcon;
  title: string;
  description: string;
  actionLabel?: string;
  onAction?: () => void;
  variant?: 'default' | 'filtered' | 'error';
}
```

#### 1-2. 統一デザインの適用
```
     ┌───────────────────────────────────┐
     │                                   │
     │          [アイコン 64px]          │
     │                                   │
     │      プロジェクトがありません       │
     │                                   │
     │   新しいプロジェクトを作成して      │
     │   創作活動を始めましょう           │
     │                                   │
     │       [ + 新規作成 ]              │
     │                                   │
     └───────────────────────────────────┘
```

#### 1-3. 適用対象画面
| 画面 | title | action |
|------|-------|--------|
| ProjectList | プロジェクトがありません | 新規作成 |
| CheckpointListView | 承認待ちの項目はありません | ダッシュボードへ |
| DataView | アセットがありません | プロジェクト実行 |
| LogsView | ログがありません | - |
| InterventionView | 返答待ちの項目はありません | - |

### 必要な作業
- [ ] EmptyStateコンポーネントの作成
- [ ] 各画面への適用（5画面）
- [ ] フィルター結果なし用のバリエーション追加

---

## 2. フォームUXの統一・改善

### 現状の問題
- バリデーションがsubmit時のみ
- 文字数制限の表示がない
- 長いフォームがステップ化されていない

### 改善内容

#### 2-1. リアルタイムバリデーションの実装
```tsx
const useFormValidation = (schema: ZodSchema) => {
  const [errors, setErrors] = useState<Record<string, string>>({});

  const validateField = (name: string, value: unknown) => {
    // フィールド単位でのバリデーション
  };

  return { errors, validateField, isValid };
};
```

#### 2-2. 入力補助UIの強化
```
┌─────────────────────────────────────────────────┐
│ コンセプト説明 *                                 │
├─────────────────────────────────────────────────┤
│ このゲームは中世ファンタジーの世界を舞台に...    │
│                                                 │
│                                                 │
├─────────────────────────────────────────────────┤
│ 45 / 500文字（最低20文字）           ✓ 有効     │
└─────────────────────────────────────────────────┘
```

#### 2-3. プロジェクト作成ウィザード化
```
[1. 基本情報] → [2. 詳細設定] → [3. 確認]
     ●              ○              ○
```

### 必要な作業
- [ ] useFormValidationフックの作成
- [ ] FormFieldコンポーネントの拡張（文字数カウンター）
- [ ] ProjectFormのステップウィザード化
- [ ] 各フォームへのリアルタイムバリデーション適用

---

## 3. Undo機能・ソフトデリートの実装

### 現状の問題
- 削除が即座に完了し、復元不可
- 一括操作時に対象の確認がない
- 危険な操作（初期化）の確認が不十分

### 改善内容

#### 3-1. ソフトデリート機能（バックエンド）
- deleted_atカラムの追加
- 30日後に完全削除
- ゴミ箱画面の追加

#### 3-2. Undo Toast
```
┌──────────────────────────────────────────────────┐
│ プロジェクト「サンプル」を削除しました    [元に戻す] │
└──────────────────────────────────────────────────┘
                         ↑ 5秒間表示
```

#### 3-3. 二重確認ダイアログ（危険な操作）
```
┌─────────────────────────────────────────────────┐
│ ⚠ プロジェクトの初期化                          │
├─────────────────────────────────────────────────┤
│                                                 │
│ この操作は取り消せません。                       │
│ 確認のため「初期化する」と入力してください：     │
│                                                 │
│ ┌─────────────────────────────────────────────┐ │
│ │                                             │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│                    [キャンセル] [実行]（無効）   │
└─────────────────────────────────────────────────┘
```

### 必要な作業
- [ ] バックエンド: ソフトデリート実装
- [ ] UndoToastコンポーネントの作成
- [ ] ConfirmDialogの二重確認モード追加
- [ ] ゴミ箱画面の作成

---

## 4. テーブル/リストの仮想スクロール対応

### 現状の問題
- 全件表示でデータ量が多いと表示が重い
- ページネーションがない
- ヘッダーが固定されていない

### 改善内容

#### 4-1. 仮想スクロールの導入
```tsx
// @tanstack/react-virtualを使用
import { useVirtualizer } from '@tanstack/react-virtual';
```

#### 4-2. ページネーション対応
```
┌────────────────────────────────────────────────────────────────┐
│ ← 前へ  1  2  3  ...  10  次へ →     20件/ページ ▼            │
└────────────────────────────────────────────────────────────────┘
```

#### 4-3. Stickyヘッダー
```css
.table-header {
  position: sticky;
  top: 0;
  z-index: 10;
}
```

### 適用対象
- DataView（アセット一覧）
- LogsView（ログ一覧）
- CheckpointListView（承認一覧）

### 必要な作業
- [ ] VirtualListコンポーネントの作成
- [ ] Paginationコンポーネントの作成
- [ ] 各画面への適用
- [ ] バックエンドのページネーションAPI対応

---

## 5. モーダル/パネルシステムの統一

### 現状の問題
- Modal, FloatingPanel, ConfirmDialogの使い分け基準がない
- フォーカストラップが未実装

### 改善内容

#### 5-1. 使用基準の明確化
| 用途 | コンポーネント |
|------|---------------|
| 確認・警告 | ConfirmDialog |
| フォーム入力 | Modal |
| 詳細表示・サブコンテンツ | FloatingPanel |
| 一時的な通知 | Toast |

#### 5-2. フォーカストラップの実装
```tsx
import { FocusTrap } from '@radix-ui/react-focus-trap';
```

#### 5-3. DetailPanelコンポーネントの作成
- 右サイドスライドイン
- 閉じるボタン
- 複数パネルのスタック対応

### 必要な作業
- [ ] Modal, FloatingPanelへのフォーカストラップ追加
- [ ] DetailPanelコンポーネントの作成
- [ ] DataViewの詳細表示をDetailPanelに移行
- [ ] 使用ガイドラインのドキュメント化

---

## 6. オンボーディング・ヘルプシステムの導入

### 現状の問題
- 初回チュートリアルがない
- 設定項目の説明が不足
- ステータスの意味が不明瞭

### 改善内容

#### 6-1. 初回ツアー機能
```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│    ┌───────────────────────────────────────────────────┐   │
│    │  ◆ ステップ 1/5                                   │   │
│    │                                                   │   │
│    │  プロジェクトの作成                               │   │
│    │                                                   │   │
│    │  ここから新しいプロジェクトを作成できます。       │   │
│    │  プロジェクトはゲーム開発の単位となります。       │   │
│    │                                                   │   │
│    │           [スキップ]  [次へ →]                    │   │
│    └───────────────────────────────────────────────────┘   │
│                         ↓ ポインター                       │
│   ┌───────────────────────────────────────────┐            │
│   │ + 新規プロジェクト                         │ ← ハイライト│
│   └───────────────────────────────────────────┘            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 6-2. ツールチップヘルプ
```
モデル [?] ←ホバーで説明表示
      ┌─────────────────────────────────────────┐
      │ 使用するAIモデルを選択します。          │
      │ 高性能モデルは精度が高いですが、       │
      │ コストも高くなります。                 │
      └─────────────────────────────────────────┘
```

#### 6-3. ステータス説明ホバー
```
[承認待ち] ←ホバー
┌────────────────────────────────────────┐
│ エージェントが作業を一時停止し、       │
│ ユーザーの承認を待っている状態です。   │
└────────────────────────────────────────┘
```

### 必要な作業
- [ ] OnboardingTourコンポーネントの作成
- [ ] Tooltipコンポーネントの拡張
- [ ] ステップデータの作成
- [ ] ユーザー設定（ツアー完了フラグ）の追加

---

## 実装ロードマップ

### フェーズ1: 基盤整備（高優先度）
1. EmptyStateコンポーネントの作成と適用
2. フォームバリデーションの統一
3. ConfirmDialogの強化

### フェーズ2: パフォーマンス・UX改善
4. 仮想スクロール/ページネーションの導入
5. モーダル/パネルシステムの統一

### フェーズ3: 安全性強化
6. Undo機能・ソフトデリートの実装

### フェーズ4: ユーザー支援（低優先度）
7. オンボーディングシステムの導入

---

## 参考資料

- NieR:Automataデザインシステム: `/home/user/toybox/langgraph-studio/src/styles/`
- 既存UIコンポーネント: `/home/user/toybox/langgraph-studio/src/components/ui/`
- Tailwind設定: `/home/user/toybox/langgraph-studio/tailwind.config.cjs`
