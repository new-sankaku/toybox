# ユーザーシナリオ一覧

## 画面構成

| # | 画面 | ファイル | 概要 |
|---|------|----------|------|
| 1 | ProjectView | `langgraph-studio/src/views/ProjectView.tsx` | プロジェクト作成・編集・実行制御 |
| 2 | AgentsView | `langgraph-studio/src/views/AgentsView.tsx` | エージェント進捗・ログ確認 |
| 3 | CheckpointsView | `langgraph-studio/src/views/CheckpointsView.tsx` | 出力レビュー・承認/却下/修正依頼 |
| 4 | LogsView | `langgraph-studio/src/views/LogsView.tsx` | システムログ表示・フィルタリング |
| 5 | TraceView | `langgraph-studio/src/views/TraceView.tsx` | LLM呼び出しトレース・トークン確認 |
| 6 | DataView | `langgraph-studio/src/views/DataView.tsx` | 生成アセット承認・ダウンロード |
| 7 | InterventionView | `langgraph-studio/src/views/InterventionView.tsx` | エージェントへの介入指示 |
| 8 | ConfigView | `langgraph-studio/src/views/ConfigView.tsx` | AI設定・自動承認・コスト・出力設定 |
| 9 | AIView | `langgraph-studio/src/views/AIView.tsx` | エージェント動作の2Dビジュアル |
| 10 | CostView | `langgraph-studio/src/views/CostView.tsx` | コスト追跡・予算管理 |

---

## 1. ProjectView - プロジェクト管理

### 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────────┐
│ [エラーメッセージ（エラー時のみ表示）]                                      │
├───────────────────────┬─────────────────────────────────────────────────┤
│ プロジェクト一覧       │ 右パネル（状態により変化）                        │
│ [更新][+新規作成]      │                                                  │
│                       │ A) 何も選択されていない時:                        │
│ ┌─────────────────┐  │    「プロジェクトを選択するか新規作成」メッセージ  │
│ │プロジェクト名    │  │    [新規プロジェクト作成]ボタン                   │
│ │説明文           │  │                                                  │
│ │ステータス[編集][削除]│ │ B) 新規作成フォーム表示時:                       │
│ └─────────────────┘  │    入力フォーム                                  │
│ ┌─────────────────┐  │                                                  │
│ │プロジェクト名    │  │ C) プロジェクト選択時:                           │
│ │...              │  │    プロジェクト詳細                              │
│ └─────────────────┘  │    実行コントロール                              │
│                       │    アップロードファイル                          │
└───────────────────────┴─────────────────────────────────────────────────┘
```

---

### シナリオ1: 新規プロジェクト作成

**前提条件:** ProjectView画面を表示している

**操作手順:**

1. 左パネル「プロジェクト一覧」ヘッダーの「+」ボタンをクリック
   - または、右パネルに「プロジェクトを選択するか、新規作成してください」が表示されている場合は「新規プロジェクト作成」ボタンをクリック

2. 右パネルに「新規プロジェクト作成」フォームが表示される

3. 以下の項目を入力:
   - **プロジェクト名**（必須）: テキスト入力
   - **ゲームアイデア**（必須）: テキストエリア入力
   - **参考ゲーム**: カンマ区切りでテキスト入力（任意）
   - **プラットフォーム**: PC / Console / Mobile から選択（ボタン形式）
   - **スコープ**: Indies / Small / Medium / Large から選択（ボタン形式）
   - **プロジェクト規模**: small / medium / large から選択（ボタン形式）
   - **AIサービス設定**: 各カテゴリごとにドロップダウンからプロバイダー:モデルを選択
   - **アセット自動生成**: チェックボックスで有効/無効を選択（画像生成、BGM生成など）
   - **コンテンツ許可**: 暴力表現、性的表現の許可チェックボックス
   - **初期ファイル**（任意）: ファイルアップローダーでカテゴリ別にファイルを追加

4. 「作成」ボタンをクリック
   - プロジェクト名とゲームアイデアが空の場合、ボタンは無効化されている

5. **結果:**
   - プロジェクトが作成される
   - 初期ファイルがあればアップロードされる（進捗表示あり）
   - 左パネルの一覧に新しいプロジェクトが追加される
   - 作成したプロジェクトが自動的に選択される
   - 右パネルがプロジェクト詳細表示に切り替わる

**キャンセル方法:** 「キャンセル」ボタンをクリック → フォームが閉じ、元の状態に戻る

**API:** `POST /api/projects`

---

### シナリオ2: プロジェクト選択

**前提条件:** ProjectView画面を表示している、プロジェクトが1つ以上存在する

**操作手順:**

1. 左パネル「プロジェクト一覧」から選択したいプロジェクトの行をクリック
   - 各行には: プロジェクト名、説明文、ステータス、編集ボタン、削除ボタンが表示されている

2. **結果:**
   - クリックした行がハイライトされる（背景色変化）
   - 右パネルにプロジェクト詳細が表示される:
     - 名前
     - ステータス（下書き/実行中/一時停止/完了/エラー）
     - 現在のフェーズ
     - ゲームアイデア
     - プラットフォーム、スコープ、ジャンル
     - 作成日時
   - 「実行コントロール」カードが表示される
   - 「アップロードファイル」カードが表示される

---

### シナリオ3: プロジェクト編集

**前提条件:** ProjectView画面を表示している、プロジェクトが1つ以上存在する

**操作手順（方法A - 一覧から編集）:**

1. 左パネルの一覧で、編集したいプロジェクト行の右側にある「鉛筆アイコン」をクリック
   - 注意: プロジェクト行自体をクリックすると選択になる。鉛筆アイコンをクリックする

2. そのプロジェクトが選択され、右パネルが編集モードで表示される

**操作手順（方法B - 詳細画面から編集）:**

1. プロジェクトを選択して詳細画面を表示する
2. 「プロジェクト詳細」カードのヘッダー右側にある「鉛筆アイコン」をクリック
   - 注意: プロジェクトが「実行中」の場合、編集ボタンは表示されない
3. 詳細表示が編集フォームに切り替わる

**編集フォームでの操作:**

3. 以下の項目を編集:
   - プロジェクト名
   - ゲームアイデア
   - プラットフォーム
   - スコープ
   - アセット自動生成設定
   - コンテンツ許可設定

4. 「保存」ボタンをクリック

5. **結果:**
   - プロジェクトが更新される
   - 編集モードが終了し、詳細表示に戻る
   - 左パネルの一覧も更新される

**キャンセル方法:** 「キャンセル」ボタンをクリック → 編集内容が破棄され、詳細表示に戻る

**API:** `PATCH /api/projects/{projectId}`

---

### シナリオ4: プロジェクト削除

**前提条件:** ProjectView画面を表示している、プロジェクトが1つ以上存在する

**操作手順:**

1. 左パネルの一覧で、削除したいプロジェクト行の右側にある「ゴミ箱アイコン」をクリック
   - 注意: 現在、確認ダイアログは表示されない。クリック即削除される

2. **結果:**
   - プロジェクトが削除される
   - 左パネルの一覧からプロジェクトが消える
   - 削除したプロジェクトが選択されていた場合、右パネルは「プロジェクトを選択するか新規作成」メッセージに戻る

**API:** `DELETE /api/projects/{projectId}`

---

### シナリオ5: プロジェクト開始

**前提条件:**
- プロジェクトを選択している
- プロジェクトのステータスが「下書き（draft）」である

**操作手順:**

1. 右パネルの「実行コントロール」カードを確認
   - ステータスが「下書き」の場合のみ「開始」ボタンが表示される

2. 「開始」ボタンをクリック

3. **結果:**
   - プロジェクトのステータスが「実行中（running）」に変わる
   - エージェントの実行が開始される
   - 「開始」ボタンが消え、「一時停止」「停止」ボタンが表示される

**API:** `POST /api/projects/{projectId}/start`

---

### シナリオ6: プロジェクト一時停止

**前提条件:**
- プロジェクトを選択している
- プロジェクトのステータスが「実行中（running）」である

**操作手順:**

1. 右パネルの「実行コントロール」カードで「一時停止」ボタンをクリック

2. **結果:**
   - プロジェクトのステータスが「一時停止（paused）」に変わる
   - エージェントの実行が一時停止される
   - 「一時停止」ボタンが消え、「再開」「停止」ボタンが表示される

**API:** `POST /api/projects/{projectId}/pause`

---

### シナリオ7: プロジェクト再開

**前提条件:**
- プロジェクトを選択している
- プロジェクトのステータスが「一時停止（paused）」である

**操作手順:**

1. 右パネルの「実行コントロール」カードで「再開」ボタンをクリック

2. **結果:**
   - プロジェクトのステータスが「実行中（running）」に変わる
   - エージェントの実行が再開される
   - 「再開」ボタンが消え、「一時停止」「停止」ボタンが表示される

**API:** `POST /api/projects/{projectId}/resume`

---

### シナリオ8: プロジェクト停止

**前提条件:**
- プロジェクトを選択している
- プロジェクトのステータスが「実行中（running）」または「一時停止（paused）」である

**操作手順:**

1. 右パネルの「実行コントロール」カードで「停止」ボタンをクリック

2. **結果:**
   - プロジェクトのステータスが「下書き（draft）」に変わる
   - エージェントの実行が停止される
   - 「停止」ボタンが消え、「開始」ボタンが表示される

**API:** `PATCH /api/projects/{projectId}` (status='draft')

---

### シナリオ9: プロジェクト初期化

**前提条件:**
- プロジェクトを選択している
- プロジェクトのステータスが「下書き（draft）」以外、または currentPhase > 1（進捗がある）

**操作手順:**

1. 右パネルの「実行コントロール」カードで「初期化」ボタンをクリック
   - ボタンは赤色で表示される（危険な操作を示す）

2. 確認ダイアログが表示される:
   - 「プロジェクト「{名前}」を初期化しますか？」
   - 「すべての進捗状況とエージェント出力がリセットされます。この操作は取り消せません。」

3. 「初期化する」ボタンをクリック

4. **結果:**
   - すべての進捗がリセットされる
   - エージェント出力が削除される
   - プロジェクトが初期状態に戻る

**キャンセル方法:** 確認ダイアログで「キャンセル」をクリック → ダイアログが閉じ、何も変更されない

**API:** `POST /api/projects/{projectId}/initialize`

---

### シナリオ10: ブラッシュアップ

**前提条件:**
- プロジェクトを選択している
- プロジェクトのステータスが「完了（completed）」である

**操作手順:**

1. 右パネルの「実行コントロール」カードで「ブラッシュアップ」ボタンをクリック

2. ブラッシュアップ設定ダイアログが表示される（画面幅70%のモーダル）

3. **セクション1: ブラッシュアップ対象エージェント**
   - フェーズごとにエージェントがグループ化されて表示される
   - フェーズ名をクリック → そのフェーズの全エージェントを一括選択/解除
   - 個別のエージェント名をクリック → そのエージェントのみ選択/解除
   - 選択したエージェントには「改善項目」のマルチセレクトが表示される
     - Ctrl+クリックで複数選択可能
   - 「選択したエージェントが生成したアセットも削除する」チェックボックス

4. **セクション2: 参考画像**
   - 提案された参考画像から選択できる
   - または新しい画像をアップロードできる

5. **セクション3: 全体への追加指示**
   - テキストエリアに全エージェント共通の追加指示を入力（任意）

6. 「ブラッシュアップ開始」ボタンをクリック
   - 少なくとも1つのエージェントを選択していないとボタンは無効化されている

7. **結果:**
   - 選択したエージェントが再実行される
   - プロジェクトのステータスが更新される
   - ダイアログが閉じる

**キャンセル方法:**
- ダイアログ右上の「×」ボタンをクリック
- または「キャンセル」ボタンをクリック
- → ダイアログが閉じ、設定がリセットされる

**API:** `POST /api/projects/{projectId}/brushup`

---

### シナリオ11: プロジェクト一覧更新

**前提条件:** ProjectView画面を表示している

**操作手順:**

1. 左パネル「プロジェクト一覧」ヘッダーの「更新」アイコン（回転矢印）をクリック

2. **結果:**
   - アイコンが回転アニメーションする（読み込み中）
   - サーバーから最新のプロジェクト一覧を取得
   - 一覧が更新される

**API:** `GET /api/projects`

---

### 実行コントロールボタンの表示条件まとめ

| ステータス | 表示されるボタン |
|-----------|-----------------|
| draft（下書き） | 開始, 初期化※ |
| running（実行中） | 一時停止, 停止 |
| paused（一時停止） | 再開, 停止 |
| completed（完了） | ブラッシュアップ, 初期化 |
| failed（エラー） | 初期化 |

※初期化ボタンは currentPhase > 1 の場合のみ表示

---

## 2. CheckpointsView - 承認管理

### 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────────┐
│ チェックポイント                                                          │
├───────────────────────┬─────────────────────────────────────────────────┤
│ チェックポイント一覧    │ チェックポイント詳細（レビューモード）             │
│                       │                                                  │
│ ┌─────────────────┐  │ CHECKPOINT - {タイトル}                          │
│ │[カテゴリ色]      │  │ Phase: {フェーズ} | 待機時間: {時間}             │
│ │タイトル          │  │                                                  │
│ │エージェント名    │  │ ┌───────────────────────────────────┐          │
│ │ステータス/作成日時│  │ │出力プレビュー  [PREVIEW][RAW]     │          │
│ └─────────────────┘  │ │                                   │          │
│                       │ │（ドキュメント/コード表示）          │          │
│ ┌─────────────────┐  │ │                                   │          │
│ │...              │  │ └───────────────────────────────────┘          │
│ └─────────────────┘  │                                                  │
│                       │ ┌───────────┐  ┌─────────────────────┐        │
│                       │ │ステータス  │  │アクション            │        │
│                       │ │種別: ...   │  │[承認][変更を要求][却下]│       │
│                       │ │状態: 承認待ち│ └─────────────────────┘        │
│                       │ └───────────┘                                  │
└───────────────────────┴─────────────────────────────────────────────────┘
```

---

### シナリオ1: チェックポイント一覧表示

**前提条件:** プロジェクトを選択している状態でCheckpointsViewタブを開く

**操作手順:**

1. サイドバーから「Checkpoints」タブをクリック

2. **結果:**
   - 左パネルにチェックポイント一覧が表示される
   - 各チェックポイントカードには以下が表示:
     - カテゴリ色（左端の縦線）
     - タイトル
     - エージェント名
     - ステータスバッジ（pending/approved/rejected/revision_requested）
     - 作成日時

**API:** `GET /api/projects/{projectId}/checkpoints`

---

### シナリオ2: チェックポイント詳細表示

**前提条件:** CheckpointsView画面を表示している、チェックポイントが1つ以上存在する

**操作手順:**

1. 左パネルの一覧からチェックポイントカードをクリック

2. **結果:**
   - 右パネルにチェックポイント詳細が表示される:
     - ヘッダー: 「CHECKPOINT - {タイトル}」「戻る」ボタン
     - サブヘッダー: Phase、待機時間（赤字）
     - 出力プレビューカード:
       - PREVIEW/RAW 切り替えタブ
       - コンテンツ表示（Markdown/コード形式）
     - メタデータ: Tokens、生成時間、作成日時
     - ステータスカード: 種別、状態
     - アクションカード: 承認/変更を要求/却下 ボタン

---

### シナリオ3: チェックポイント承認

**前提条件:** チェックポイント詳細を表示している、ステータスが「pending」である

**操作手順:**

1. 右パネルの「アクション」カードで「承認」ボタン（緑色）をクリック

2. **結果:**
   - チェックポイントのステータスが「approved」に変わる
   - 次の処理に進む（エージェントが次のタスクを実行）
   - 画面が更新される

**API:** `POST /api/checkpoints/{checkpointId}/resolve` (status='approved')

---

### シナリオ4: 変更を要求

**前提条件:** チェックポイント詳細を表示している、ステータスが「pending」である

**操作手順:**

1. 右パネルの「アクション」カードで「変更を要求」ボタンをクリック

2. フィードバック入力フォームが表示される:
   - 「変更要求内容」ヘッダー
   - テキストエリア（「フィードバックを入力...」プレースホルダー）
   - 「送信」ボタン、「キャンセル」ボタン

3. フィードバック内容をテキストエリアに入力

4. 「送信」ボタンをクリック
   - テキストが空の場合、ボタンは無効化されている

5. **結果:**
   - チェックポイントのステータスが「revision_requested」に変わる
   - フィードバックが保存される
   - エージェントが修正を開始する
   - フォームが閉じる

**キャンセル方法:** 「キャンセル」ボタンをクリック → フォームが閉じ、入力内容がクリアされる

**API:** `POST /api/checkpoints/{checkpointId}/resolve` (status='revision_requested', feedback={入力内容})

---

### シナリオ5: 却下

**前提条件:** チェックポイント詳細を表示している、ステータスが「pending」である

**操作手順:**

1. 右パネルの「アクション」カードで「却下」ボタン（赤色）をクリック

2. 却下理由入力フォームが表示される:
   - 「却下理由」ヘッダー
   - テキストエリア（「フィードバックを入力...」プレースホルダー）
   - 「送信」ボタン（赤色）、「キャンセル」ボタン

3. 却下理由をテキストエリアに入力

4. 「送信」ボタンをクリック
   - テキストが空の場合、ボタンは無効化されている

5. **結果:**
   - チェックポイントのステータスが「rejected」に変わる
   - 却下理由が保存される
   - フォームが閉じる

**キャンセル方法:** 「キャンセル」ボタンをクリック → フォームが閉じ、入力内容がクリアされる

**API:** `POST /api/checkpoints/{checkpointId}/resolve` (status='rejected', reason={入力内容})

---

### シナリオ6: 出力表示モード切り替え

**前提条件:** チェックポイント詳細を表示している

**操作手順:**

1. 「出力プレビュー」カードのヘッダーにある「PREVIEW」または「RAW」ボタンをクリック

2. **結果:**
   - PREVIEW: ドキュメント形式で整形表示（Markdown対応）
   - RAW: 生データをコードビューアで表示

---

## 3. DataView - アセット管理

### 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────────┐
│ アセット管理                                                             │
├───────────────────────┬─────────────────────────────────────────────────┤
│ フィルタ              │ アセット一覧（グリッド/リスト）                    │
│                       │                                                  │
│ タイプ                │ ┌────┐┌────┐┌────┐┌────┐                       │
│ ○ 全て (n)           │ │サムネ││サムネ││サムネ││サムネ│                      │
│ ○ 画像 (n)           │ │名前 ││名前 ││名前 ││名前 │                       │
│ ○ 音声 (n)           │ │[✓][✗]││[✓][✗]││[✓][✗]││[✓][✗]│                     │
│ ○ ドキュメント (n)   │ └────┘└────┘└────┘└────┘                       │
│ ○ コード (n)         │                                                  │
│                       │ ┌────┐┌────┐┌────┐┌────┐                       │
│ 承認状態              │ │...  ││...  ││...  ││...  │                       │
│ ○ 全状態 (n)         │ └────┘└────┘└────┘└────┘                       │
│ ○ 未承認 (n)         │                                                  │
│ ○ 承認済 (n)         │                                                  │
│ ○ 却下 (n)           │                                                  │
│                       │                                                  │
│ 表示                  │                                                  │
│ [グリッド][リスト]    │                                                  │
└───────────────────────┴─────────────────────────────────────────────────┘
```

---

### シナリオ1: アセット一覧表示

**前提条件:** プロジェクトを選択している状態でDataViewタブを開く

**操作手順:**

1. サイドバーから「Data」タブをクリック

2. **結果:**
   - 左パネルにフィルタオプションが表示される
   - 右パネルにアセット一覧が表示される（デフォルト: グリッド表示、未承認フィルタ）
   - 各アセットカードには以下が表示:
     - サムネイル（画像）またはアイコン（音声/ドキュメント/コード）
     - ファイル名
     - サイズ + ステータスバッジ
     - 承認ボタン（✓）、却下ボタン（✗）

**API:** `GET /api/projects/{projectId}/assets`

---

### シナリオ2: タイプでフィルタ

**前提条件:** DataView画面を表示している

**操作手順:**

1. 左パネルの「タイプ」セクションで選択したいタイプのラジオボタンをクリック:
   - 全て
   - 画像
   - 音声
   - ドキュメント
   - コード

2. **結果:**
   - 右パネルの一覧が選択したタイプのみにフィルタリングされる
   - 各選択肢の横に件数が表示される

---

### シナリオ3: 承認状態でフィルタ

**前提条件:** DataView画面を表示している

**操作手順:**

1. 左パネルの「承認状態」セクションで選択したい状態のラジオボタンをクリック:
   - 全状態
   - 未承認（pending）← デフォルト
   - 承認済（approved）
   - 却下（rejected）

2. **結果:**
   - 右パネルの一覧が選択した承認状態のみにフィルタリングされる

---

### シナリオ4: 表示モード切り替え

**前提条件:** DataView画面を表示している

**操作手順:**

1. 左パネルの「表示」セクションで「グリッド」または「リスト」ボタンをクリック

2. **結果:**
   - グリッド: カード形式で複数列表示（レスポンシブ）
   - リスト: 表形式で詳細情報表示（タイプ、状態、エージェント、サイズ、作成日時）

---

### シナリオ5: アセット承認（一覧から）

**前提条件:** DataView画面を表示している、アセットが存在する

**操作手順:**

1. アセットカードの「✓」ボタン（緑色）をクリック
   - または、リスト表示の場合は行の承認ボタンをクリック

2. **結果:**
   - アセットのステータスが「approved」に変わる
   - ステータスバッジが「承認済」に更新される
   - 一覧が自動的に再読み込みされる

**API:** `PUT /api/projects/{projectId}/assets/{assetId}/status?status=approved`

---

### シナリオ6: アセット却下（一覧から）

**前提条件:** DataView画面を表示している、アセットが存在する

**操作手順:**

1. アセットカードの「✗」ボタン（赤色）をクリック

2. **結果:**
   - アセットのステータスが「rejected」に変わる
   - ステータスバッジが「却下」に更新される
   - 一覧が自動的に再読み込みされる

**API:** `PUT /api/projects/{projectId}/assets/{assetId}/status?status=rejected`

---

### シナリオ7: アセット詳細表示

**前提条件:** DataView画面を表示している、アセットが存在する

**操作手順:**

1. アセットカード自体をクリック（承認/却下ボタン以外の領域）
   - または、リスト表示の場合はアイコン列をクリック

2. **結果:**
   - モーダルダイアログが表示される:
     - ヘッダー: アイコン + ファイル名 + 閉じるボタン（×）
     - コンテンツ:
       - 画像: フルサイズ画像表示
       - 音声: プレイヤーUI（再生ボタン）
       - ドキュメント: Markdownリッチテキスト表示
       - コード: シンタックスハイライト表示
     - フッター:
       - メタ情報（タイプ、承認状態、サイズ、生成エージェント、作成日時）
       - 承認ボタン（承認済でない場合）
       - 却下ボタン（却下でない場合）
       - ダウンロードボタン
       - 閉じるボタン

**閉じる方法:**
- モーダル右上の「×」ボタンをクリック
- または「閉じる」ボタンをクリック
- または背景（オーバーレイ）をクリック

---

### シナリオ8: 音声再生

**前提条件:** DataView画面を表示している、音声アセットが存在する

**操作手順:**

1. グリッド表示: 音声アセットカードの再生ボタン（▶）をクリック
   - または、詳細モーダルで再生ボタンをクリック

2. **結果:**
   - 音声が再生される
   - アイコンが一時停止ボタン（⏸）に変わる

3. 再度クリックすると一時停止し、再生位置がリセットされる

---

### シナリオ9: アセットダウンロード

**前提条件:** DataView画面を表示している、アセットが存在する

**操作手順:**

1. リスト表示の行の「ダウンロード」ボタンをクリック
   - または、詳細モーダルの「ダウンロード」ボタンをクリック

2. **結果:**
   - ブラウザのダウンロードが開始される
   - ファイルがローカルに保存される

**API:** `GET /api/assets/{assetId}/download`

---

## 4. LogsView - システムログ

### 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────────┐
│ システムログ                                                             │
├─────────────────────────────────────────┬───────────────────────────────┤
│ ログ一覧                                │ フィルタ / 詳細パネル          │
│                                         │                               │
│ [時刻] [レベル] [ソース] メッセージ      │ 検索                          │
│ [時刻] [レベル] [ソース] メッセージ      │ [テキスト入力ボックス]         │
│ [時刻] [レベル] [ソース] メッセージ      │                               │
│ [時刻] [レベル] [ソース] メッセージ      │ レベル                        │
│ ...                                     │ ○ 全て (n)                   │
│                                         │ ○ error (n)                  │
│                                         │ ○ warn (n)                   │
│                                         │ ○ info (n)                   │
│                                         │ ○ debug (n)                  │
│                                         │                               │
│                                         │ エージェント                  │
│                                         │ [ドロップダウン選択]          │
│                                         │                               │
│                                         │ 統計                          │
│                                         │ エラー: n件                   │
│                                         │ 警告: n件                     │
│                                         │ ...                           │
└─────────────────────────────────────────┴───────────────────────────────┘
```

---

### シナリオ1: ログ一覧表示

**前提条件:** プロジェクトを選択している状態でLogsViewタブを開く

**操作手順:**

1. サイドバーから「Logs」タブをクリック

2. **結果:**
   - 左パネルにログ一覧が表示される（逆時系列）
   - 各ログ行: [時刻] [レベルアイコン] [ソース] メッセージ
   - 右パネルにフィルタオプションと統計が表示される

**API:** `GET /api/projects/{projectId}/logs`

---

### シナリオ2: ログレベルでフィルタ

**前提条件:** LogsView画面を表示している

**操作手順:**

1. 右パネルの「レベル」セクションで選択したいレベルのラジオボタンをクリック:
   - 全て
   - error（エラーのみ）
   - warn（警告のみ）
   - info（情報のみ）
   - debug（デバッグのみ）

2. **結果:**
   - 左パネルのログ一覧が即座にフィルタリングされる

---

### シナリオ3: エージェントでフィルタ

**前提条件:** LogsView画面を表示している

**操作手順:**

1. 右パネルの「エージェント」ドロップダウンをクリック

2. 表示されるオプション:
   - 「全選択/解除」ボタン
   - 個別エージェント名（複数選択可能、Ctrl+クリック対応）

3. 表示したいエージェントを選択

4. **結果:**
   - 選択したエージェントのログのみ表示される

---

### シナリオ4: テキスト検索

**前提条件:** LogsView画面を表示している

**操作手順:**

1. 右パネルの「検索」テキストボックスに検索キーワードを入力

2. **結果:**
   - メッセージとソース（エージェント名）に対してリアルタイム検索
   - 一致するログのみ表示される

---

### シナリオ5: ログ詳細表示

**前提条件:** LogsView画面を表示している、ログが存在する

**操作手順:**

1. 左パネルのログ行をクリック

2. **結果:**
   - 右パネルにFloatingPanelで詳細が表示される:
     - タイムスタンプ（フォーマット済み）
     - レベル
     - ソース
     - メッセージ本体
     - 詳細情報（JSON形式、スクロール可能）

---

## 5. TraceView - トレース追跡

### 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────────┐
│ トレース  [自動更新] [更新] [全展開] [全閉] [削除]                        │
├─────────────────────────────────────────┬───────────────────────────────┤
│ トレース一覧                            │ フィルタ / 統計               │
│                                         │                               │
│ ▶ [アイコン] Agent名 [ステータス]       │ ステータス                    │
│   Duration: 1.2s | Tokens: 1,234        │ ○ 全て (n)                   │
│                                         │ ○ 完了 (n)                   │
│ ▼ [アイコン] Agent名 [ステータス]       │ ○ 実行中 (n)                 │
│   Duration: 2.3s | Tokens: 2,345        │ ○ エラー (n)                 │
│   ┌─────────────────────────────────┐  │                               │
│   │モデル: gpt-4                     │  │ 統計                          │
│   │入力: 1,000                       │  │ 総トレース数: n               │
│   │出力: 345                         │  │ 総トークン: n                 │
│   │[詳細を表示]                      │  │ 平均処理時間: n秒             │
│   └─────────────────────────────────┘  │                               │
│                                         │                               │
└─────────────────────────────────────────┴───────────────────────────────┘
```

---

### シナリオ1: トレース一覧表示

**前提条件:** プロジェクトを選択している状態でTraceViewタブを開く

**操作手順:**

1. サイドバーから「Trace」タブをクリック

2. **結果:**
   - 左パネルにトレース一覧が表示される（逆時系列）
   - 各トレースカード: [展開アイコン] [サービスアイコン] Agent名 [ステータス] Duration Tokens 時刻
   - 右パネルにフィルタオプションと統計が表示される

**API:** `GET /api/projects/{projectId}/traces`

---

### シナリオ2: ステータスでフィルタ

**前提条件:** TraceView画面を表示している

**操作手順:**

1. 右パネルの「ステータス」セクションで選択したいステータスのラジオボタンをクリック:
   - 全て
   - 完了（completed）
   - 実行中（running）- スピナーアニメーション付き
   - エラー（error）

2. **結果:**
   - 左パネルのトレース一覧がフィルタリングされる

---

### シナリオ3: トレース展開/折りたたみ

**前提条件:** TraceView画面を表示している、トレースが存在する

**操作手順:**

1. トレースカード左側の「▶」または「▼」アイコンをクリック

2. **結果:**
   - ▶ クリック: トレースが展開され、詳細情報が表示される
     - モデル名
     - 入力トークン数
     - 出力トークン数
     - 処理時間
     - エラーメッセージ（エラー時のみ）
     - 「詳細を表示」ボタン
   - ▼ クリック: トレースが折りたたまれる

---

### シナリオ4: 全展開/全閉

**前提条件:** TraceView画面を表示している、トレースが存在する

**操作手順:**

1. ヘッダーの「全展開」ボタンをクリック → すべてのトレースが展開される
2. ヘッダーの「全閉」ボタンをクリック → すべてのトレースが折りたたまれる

---

### シナリオ5: トレース詳細表示

**前提条件:** TraceView画面を表示している、トレースを展開している

**操作手順:**

1. 展開したトレース内の「詳細を表示」ボタンをクリック

2. **結果:**
   - FloatingPanel（大サイズ）で詳細情報が表示される:
     - Agent / Type / Status / Model
     - 開始時刻 / 完了時刻 / 処理時間 / トークン数
     - エラーメッセージ（プリフォーマット）
     - 入力コンテキスト（JSON表示）
     - 送信プロンプト（プリフォーマット、スクロール対応）
     - LLMレスポンス（プリフォーマット）
     - 出力データ（JSON表示）

**閉じる方法:** パネル右上の「×」ボタンをクリック

---

### シナリオ6: 自動更新

**前提条件:** TraceView画面を表示している

**操作手順:**

1. ヘッダーの「自動更新」ボタンをクリック

2. **結果:**
   - ボタンがハイライト状態になる
   - スピナーアニメーションが表示される
   - 3秒ごとにトレース一覧が自動更新される

3. 再度「自動更新」ボタンをクリックで停止

---

### シナリオ7: 手動更新

**前提条件:** TraceView画面を表示している

**操作手順:**

1. ヘッダーの「更新」ボタンをクリック

2. **結果:**
   - トレース一覧が即座に再読み込みされる

---

### シナリオ8: トレース削除

**前提条件:** TraceView画面を表示している、トレースが存在する

**操作手順:**

1. ヘッダーの「削除」ボタンをクリック

2. 確認ダイアログが表示される

3. 「削除」を確認

4. **結果:**
   - プロジェクト内のすべてのトレースが削除される
   - 一覧が空になる

**API:** `DELETE /api/projects/{projectId}/traces`

---

## API一覧

### Projects API
| メソッド | エンドポイント | 説明 |
|----------|---------------|------|
| GET | `/api/projects` | プロジェクト一覧取得 |
| POST | `/api/projects` | 新規プロジェクト作成 |
| PATCH | `/api/projects/{projectId}` | プロジェクト更新 |
| DELETE | `/api/projects/{projectId}` | プロジェクト削除 |
| POST | `/api/projects/{projectId}/start` | プロジェクト開始 |
| POST | `/api/projects/{projectId}/pause` | プロジェクト一時停止 |
| POST | `/api/projects/{projectId}/resume` | プロジェクト再開 |
| POST | `/api/projects/{projectId}/initialize` | プロジェクト初期化 |
| POST | `/api/projects/{projectId}/brushup` | ブラッシュアップ |

### Checkpoints API
| メソッド | エンドポイント | 説明 |
|----------|---------------|------|
| GET | `/api/projects/{projectId}/checkpoints` | チェックポイント一覧取得 |
| POST | `/api/checkpoints/{checkpointId}/resolve` | チェックポイント解決（承認/却下/修正依頼） |

### Assets API
| メソッド | エンドポイント | 説明 |
|----------|---------------|------|
| GET | `/api/projects/{projectId}/assets` | アセット一覧取得 |
| PUT | `/api/projects/{projectId}/assets/{assetId}/status` | アセット状態更新 |
| GET | `/api/assets/{assetId}/download` | アセットダウンロード |

### Logs API
| メソッド | エンドポイント | 説明 |
|----------|---------------|------|
| GET | `/api/projects/{projectId}/logs` | システムログ取得 |

### Traces API
| メソッド | エンドポイント | 説明 |
|----------|---------------|------|
| GET | `/api/projects/{projectId}/traces` | トレース一覧取得 |
| DELETE | `/api/projects/{projectId}/traces` | トレース全削除 |

---

## 関連ファイル

### Views
- `langgraph-studio/src/views/ProjectView.tsx`
- `langgraph-studio/src/views/CheckpointsView.tsx`
- `langgraph-studio/src/views/DataView.tsx`
- `langgraph-studio/src/views/LogsView.tsx`
- `langgraph-studio/src/views/TraceView.tsx`

### Components
- `langgraph-studio/src/components/checkpoints/CheckpointReviewView.tsx`
- `langgraph-studio/src/components/checkpoints/ApprovalButtons.tsx`
- `langgraph-studio/src/components/ui/FloatingPanel.tsx`
- `langgraph-studio/src/components/project/AssetFileUploader.tsx`
- `langgraph-studio/src/components/brushup/BrushupReferenceImages.tsx`

### Stores
- `langgraph-studio/src/stores/projectStore.ts`
- `langgraph-studio/src/stores/checkpointStore.ts`
- `langgraph-studio/src/stores/assetStore.ts`
- `langgraph-studio/src/stores/logStore.ts`
- `langgraph-studio/src/stores/traceStore.ts`
- `langgraph-studio/src/stores/brushupStore.ts`
